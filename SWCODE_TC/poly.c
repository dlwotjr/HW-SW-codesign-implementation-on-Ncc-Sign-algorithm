#include "poly.h"

#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

#include "./sign.h"
#include "packing.h"
#include "params.h"
#include "reduce.h"
#include "rounding.h"
#include "symmetric.h"

#if NIMS_TRI_NTT_MODE == 1
#define MONT 1781889

#define Wmont 1857311
#define W2mont 4762337
#define F1 5143946
#define F2 1886355
#define F1_woo 1861262
#define F2_woo 3722524
#define radix3_len 3
#define radix2_redlen_ntt (N >> 8)
#define radix2_redlen_invntt (N >> 3)
int32_t zetas[1151] = {
		3639200, 2686861, 6424568, 6554301, 7526435, 877607, 306698, 4659475, 2808328, 1552595,
		1424358, 2775436, 5524170, 1878681, 6481742, 3390155, 4282716, 2116573, 5543577, 3460077,
		432998, 6433532, 184706, 5190529, 8309856, 907034, 1179760, 8184262, 2536834, 4693847,
		4814234, 180498, 4004427, 2486172, 1251, 2440877, 3564940, 6469915, 7099282, 2162462,
		1524716, 7594467, 3264673, 8348313, 5056889, 3125966, 4070954, 5394914, 1732710, 1054835,
		8089830, 1595450, 7283296, 5691488, 5642710, 6112046, 88822, 6502665, 4068162, 3845994,
		801959, 8233299, 7392628, 3132507, 7290507, 1957344, 6032763, 1485307, 3001095, 347708,
		7922675, 7044727, 4274417, 2831444, 1643646, 8315960, 1758450, 4932998, 3590231, 4706816,
		3277849, 4050420, 7601909, 5145204, 7823061, 959142, 33147, 5706219, 5641511, 7716605,
		2768240, 662643, 6249357, 7628050, 4602216, 35121, 74136, 2427534, 7254923, 128776,
		6297943, 418975, 6436867, 5925628, 6136950, 6663782, 1962506, 5391729, 5785737, 5281972,
		2650439, 821034, 6317452, 4418807, 4770462, 2888434, 3205705, 1652755, 966215, 7352241,
		989379, 6977760, 3823033, 4378563, 814504, 3440373, 1721, 166697, 6845588, 3919256, 3438345,
		3723422, 1882396, 3547575, 1555949, 6400991, 3281506, 2809088, 1173945, 1253810, 4455451,
		3989177, 5120031, 2762523, 2497947, 5640971, 5241189, 259380, 7739136, 5659819, 5903590,
		8164013, 4626509, 5067109, 5700756, 4870071, 1925728,
		1335085, 3775028, 6000207, 3986235, 6301921, 5153193, 2235158, 737891, 8223422, 4415302,
		3844299, 2372245, 8227131, 1203793, 7548598, 3576038, 7192649, 6029292, 7355171, 4185321,
		1311251, 924531, 2222840, 5109852, 4514923, 4216216, 8025058, 6796594, 273132, 5125424,
		7441504, 3520481, 3600911, 1604943, 6786372, 5073513, 3965136, 7052183, 130820, 3724159,
		8163426, 3328024, 4794542, 3390860, 5221396, 6921825, 4607652, 1911148, 6576914, 5010677,
		514029, 3935336, 1328031, 4486445, 3824161, 20244, 471459, 4466201, 5324318, 5560875,
		7777014, 6127693, 7613357, 3287031, 837334, 2840662, 913651, 4403202, 2603493, 5034447,
		126705, 1036112, 97875, 3998335, 433968, 1504803, 1846049, 2324173, 2922670, 3828976,
		7083542, 6896734, 7639038, 5784777, 4320431, 252265, 1995241, 6037042, 2207645, 2616760,
		1674074, 2786635, 6194638, 5032277, 8028620, 7818912, 6609610, 5614902, 1672121, 5236652,
		88165, 6884768, 730565, 3719883, 5051056, 3164885, 5366704, 6982292, 2280675, 7058482,
		6838596, 5639237, 1624362, 1419245, 4965202, 8038247, 1128088, 4667850, 3278486, 4304560,
		5814750, 363290, 7433838, 6240075, 35252, 5924414, 4768038, 3762952, 5166111, 2161462,
		5215641, 4042892, 2836346, 1013632, 7643252, 5056524, 693331, 4358645, 4663564, 5484672,
		2565047, 6782582, 4698106, 3865717, 3748470, 2916865, 1084779, 6228893, 3574146, 6979264,
		5502127, 4806620, 2032195, 2172644, 1082847, 2591025, 5934871, 5723287, 7768152, 8314312,
		8349902, 5810512, 5525650, 6692897, 5969160, 5057514, 2349929, 3348874, 1012578, 1708640,
		2857261, 2377575, 7805834, 7061874, 7920304, 1037912, 5198125, 6023962, 146560, 4014599,
		967589, 1394046, 5559678, 5408645, 7945891, 4386938, 5427915, 4293417, 6435730, 3940482,
		2809349, 8233899, 6825926, 4108120, 7566859, 1313441, 4278600, 3090802, 6155990, 4404243,
		4901487, 7088096, 485894, 5729593, 4574612, 6595564, 6978853, 3923620, 2087784, 2671944,
		5369630, 3926154, 3027904, 2190967, 6389872, 6117121, 4049739, 4475383, 1099759, 3345374,
		3104, 7571714, 230125, 2515551, 5404480, 5056163, 6665025, 1055950, 5397364, 7983055,
		8357888, 3421184, 4410150, 4092812, 1416683, 7195496, 5728828, 6185265, 7779633, 2216272,
		869976, 7513996, 5677537, 7345587, 7289392, 8251446, 7040902, 5766783, 7670156, 4308725,
		6768989, 6272686, 5312884, 1804128, 4912184, 5236045, 1525494, 5379350, 7224001, 5838419,
		8032750, 4157775, 6366809, 4243762, 1463651, 2213858, 1286086, 2128851, 1998401, 3709568,
		350843, 5961903, 5982363, 3022187, 1729880, 1444848, 2867333, 2520659, 8114824, 8176527,
		5619998, 7414630, 5451998, 8157324, 891074, 3019018, 2884256, 5382519, 1623184, 7189620,
		1780643, 6956689, 2037329, 1200635, 5795677, 5539677, 6705351, 986907, 5544997, 7293981,
		7269149, 822304, 1272183, 6331963, 8248400, 7784199, 2850064, 6730950, 5995097, 7818575,
		6785547, 582962, 1610847, 5714625, 1972010, 1107556, 3988549, 5623394, 6186475, 239342,
		4137664, 617338, 6427198, 1761884, 7442507, 4347876, 146701, 4587787, 2338904, 325165,
		4336178, 2939034, 7937225, 1332138, 1822626, 7069399, 544749, 4912952, 1389189, 6639653,
		7387824, 4700918, 7389544, 5680014, 7364226, 8076372, 5700908, 2689186, 3381791, 7807571,
		1186891, 6253391, 8398078, 3810723, 3050069, 1689658, 4760685, 7372983, 7110541, 1028554,
		7749009, 1662577, 461062, 5712351, 3916284, 4378844, 4563661, 6779017, 104652, 4590814,
		4911153, 8388112, 2257957, 4238909, 750546, 5876447, 2837347, 2591074, 7364365, 4845849,
		3895548, 6395666, 1272944, 2005871, 97634, 65984, 301773, 13425, 116406, 4832424,
		2604530, 2233038, 1618071, 5810463, 3682449, 7366625, 336813, 2140402, 2378882, 6161882,
		6856111, 3080743, 259546, 5753620, 7726772, 1461437, 694493, 6940100, 5320068, 841088,
		7229206, 1034912, 4902281, 4718708, 5084858, 3601839, 6490674, 5320794, 1560222, 3366627,
		6673736, 1387431, 5435217, 1456875, 4973489, 6802716, 676078, 3189565, 1048441, 7520903,
		7208192, 880634, 3156148, 8259591, 5084688, 5034910, 2426084, 6556192, 3834447, 506797,
		6168821, 1598821, 7425926, 3334575, 3057769, 2283912, 348882, 1539320, 494139, 5867745,
		7702617, 221956, 4621787, 2350794, 3870025, 6050743, 4531429, 7407065, 5033868, 5066962,
		1645681, 3556531, 1048954, 4634706, 3492407, 2533792, 4090292, 2867599, 6066303, 375767,
		3522876, 4806010, 2911167, 8130447, 8036213, 7256718, 4127023, 6726637, 4931633, 1674900,
		1565727, 4534920, 1659243, 5533938, 7030537, 1722780, 2986958, 7102404, 7086664, 271090,
		6661532, 8251647, 1433627, 4659462, 6534493, 2206251, 7579864, 545577, 7298144, 6773636,
		8123459, 1882877, 8069214, 6518660, 1169641, 2751828, 631538, 149890, 1554066, 6623746,
		3911736, 6542339, 4865068, 7855960, 5971606, 7552197, 1214256, 4675293, 5494430, 4274332,
		4724383, 7031319, 5691014, 7292838, 3937736, 3357277, 334192, 5044260, 1372155, 2904114,
		3492578, 849340, 6397371, 6443498, 1932093, 8032570, 1952112, 1370218, 5732876, 2529673,
		332153, 776340, 5769014, 5623332, 2209806, 5465102, 5787086, 4789376, 2758040, 5774153,
		7029097, 2627384, 7892769, 2686897, 4988024, 5871864, 6915676, 7319049, 6758531, 6550493,
		718978, 2936435, 905530, 7690598, 6502344, 8009749, 4402068, 317038, 6911650, 3694781,
		6016716, 5415336, 452555, 3207273, 7753405, 5194264, 7352045, 4011819, 7593818, 710939,
		1837278, 4704397, 5448151, 2815485, 5939777, 4706756, 5300999, 243836, 4940590, 1565819,
		7871804, 56413, 5492095, 44944, 877240, 4823119, 8188766, 2207844, 2102600, 6193693,
		311750, 101357, 8013418, 8157701, 5728214, 5066955, 1827084, 3773663, 7376204, 8356593,
		7402811, 3550421, 6279939, 5065101, 1667742, 1071664, 868824, 6227003, 6241571, 7572800,
		5983894, 7163505, 2613809, 1238032, 2194640, 7298667, 1106173, 4851116, 5052715, 2721684,
		7540196, 3827069, 6358048, 2174534, 2000622, 2002206, 386535, 5459951, 3151447, 7084159,
		5680212, 5912141, 1029201, 5179930, 8364935, 2725193, 6237576, 5676344, 5212315, 4594763,
		110922, 6399331, 6154074, 7182136, 4350830, 8185144, 4439090, 2489396, 6732205, 1930591,
		6753105, 4241250, 779309, 6020930, 5349334, 6917451, 6231802, 972083, 3167615, 2910987,
		6712821, 5490550, 4224895, 4536844, 8002439, 6470946, 4038844, 2902674, 8034990, 7152237,
		422949, 1484086, 5775104, 8368151, 7486873, 5486853, 99336, 5216654, 5161793, 3598049,
		5797824, 7265323, 3830902, 7598667, 8170391, 802870, 2405954, 413166, 125372, 33386,
		1794968, 7231937, 4605560, 4683983, 2154908, 4803488, 4949988, 3365037, 7792083, 1870695,
		2738253, 31351, 2169683, 3993044, 6367918, 1820338, 6361249, 4589212, 521183, 3812325,
		1521152, 4024395, 1094223, 5036500, 5198194, 5185375, 6893471, 6459907, 6938845, 4408493,
		7186745, 2752032, 7486996, 6048222, 3233448, 7000252, 3815064, 6617490, 387443, 4892947,
		6615927, 355439, 1253114, 8046098, 3417988, 5216205, 2207387, 5649505, 6402334, 7644979,
		4213423, 6403661, 316844, 1784047, 4142843, 3392613, 3309611, 51966, 295518, 120838,
		5265114, 6244362, 5517655, 1599226, 8316386, 1601446, 2896051, 6800091, 326103, 6365200,
		2634223, 5008924, 5678895, 4991839, 667587, 1653412, 7845810, 2157175, 5383208, 8131423,
		2978262, 4011609, 258976, 6005912, 3063667, 1064785, 2274526, 5456268, 3271346, 4050356,
		1675551, 4351181, 1097736, 7070697, 4083424, 270114, 5519289, 5186154, 2411258, 8061965,
		2079298, 7336752, 2746890, 15659, 6947179, 883906, 4155353, 892614, 5130846, 5562656,
		5970049, 6937875, 270021, 8333695, 438319, 67842, 318122, 6455270, 5418701, 8385878,
		3788125, 6953534, 1047748, 816064, 3295236, 2838881, 4154298, 7052845, 7488303, 3191435,
		2520594, 8379212, 6785910, 3791820, 5327580, 745503, 1100786, 4089772, 8281822, 4311765,
		8161022, 3769495, 560710, 1348692, 5702415, 7798348, 7355223, 7281207, 2916424, 4609717,
		1633202, 525574, 1105642, 2359345, 1641973, 1787803, 7001742, 7874901, 821968, 4494445,
		7595588, 7690642, 5571547, 710895, 3459109, 1261167, 6359710, 7875963, 7801679, 5020019,
		5449617, 1648450, 466968, 526636, 5098134, 2779781, 1332486, 2147861, 5805650, 2563232,
		6517875, 572186, 6293378, 4012364, 3941538, 1971968, 616815, 6429569, 3474086, 3135418,
		4175637, 5621756, 1739836, 6792145, 2251860, 4119829, 7688522, 7829351, 367439, 241443,
		4682997, 3212560, 6671437, 3226644, 2009336, 5052706, 7467958, 2144163, 915068, 6508849,
		2939820, 1892688, 1664987, 8279350, 5278158, 8160094, 204366, 2385606, 1895933, 1319872,
		6587455, 3348831, 5636171, 6679460, 2390628, 7457950, 3457582, 6879627, 4164448, 2107577,
		5873513, 2664537, 7044546, 3156780, 5600839, 5244757, 1894707, 585667, 4241348, 1722077,
		5184230, 942460, 7020864, 2213193, 7124957, 6293960, 6591521, 201694, 1711942, 3626816,
		1118915, 5782088, 6032329, 7171571, 4433273, 6323640, 5775317, 5117609, 6402647, 3283928,
		2557816, 4552122, 3106767, 8199843, 6111656, 6525334, 1985829, 342888, 496823, 1229966,
		5792942, 2848026, 6892148, 3122682, 891628, 2930021, 4736346, 7138788, 3961614, 86993,
		2235645, 4026841, 2277930, 4374696, 2713240, 1667272, 4023269, 5553511, 2711720, 2935019,
		333336, 7149523, 5175216, 1262749};

int32_t zetas_inv[1151] = {
		5175216, 1262749, 333336, 7149523, 2711720, 2935019, 4023269, 5553511, 2713240, 1667272,
		2277930, 4374696, 2235645, 4026841, 3961614, 86993, 4736346, 7138788, 891628, 2930021,
		6892148, 3122682, 5792942, 2848026, 496823, 1229966, 1985829, 342888, 6111656, 6525334,
		3106767, 8199843, 2557816, 4552122, 6402647, 3283928, 5775317, 5117609, 4433273, 6323640,
		6032329, 7171571, 1118915, 5782088, 1711942, 3626816, 6591521, 201694, 7124957, 6293960,
		7020864, 2213193, 5184230, 942460, 4241348, 1722077, 1894707, 585667, 5600839, 5244757,
		7044546, 3156780, 5873513, 2664537, 4164448, 2107577, 3457582, 6879627, 2390628, 7457950,
		5636171, 6679460, 6587455, 3348831, 1895933, 1319872, 204366, 2385606, 5278158, 8160094,
		1664987, 8279350, 2939820, 1892688, 915068, 6508849, 7467958, 2144163, 2009336, 5052706,
		6671437, 3226644, 4682997, 3212560, 367439, 241443, 7688522, 7829351, 2251860, 4119829,
		1739836, 6792145, 4175637, 5621756, 3474086, 3135418, 616815, 6429569, 3941538, 1971968,
		6293378, 4012364, 6517875, 572186, 5805650, 2563232, 1332486, 2147861, 5098134, 2779781,
		466968, 526636, 5449617, 1648450, 7801679, 5020019, 6359710, 7875963, 3459109, 1261167,
		5571547, 710895, 7595588, 7690642, 821968, 4494445, 7001742, 7874901, 1641973, 1787803,
		1105642, 2359345, 1633202, 525574, 2916424, 4609717, 7355223, 7281207, 5702415, 7798348,
		560710, 1348692, 8161022, 3769495, 8281822, 4311765, 1100786, 4089772, 5327580, 745503,
		6785910, 3791820, 2520594, 8379212, 7488303, 3191435, 4154298, 7052845, 3295236, 2838881,
		1047748, 816064, 3788125, 6953534, 5418701, 8385878, 318122, 6455270, 438319, 67842,
		270021, 8333695, 5970049, 6937875, 5130846, 5562656, 4155353, 892614, 6947179, 883906,
		2746890, 15659, 2079298, 7336752, 2411258, 8061965, 5519289, 5186154, 4083424, 270114,
		1097736, 7070697, 1675551, 4351181, 3271346, 4050356, 2274526, 5456268, 3063667, 1064785,
		258976, 6005912, 2978262, 4011609, 5383208, 8131423, 7845810, 2157175, 667587, 1653412,
		5678895, 4991839, 2634223, 5008924, 326103, 6365200, 2896051, 6800091, 8316386, 1601446,
		5517655, 1599226, 5265114, 6244362, 295518, 120838, 3309611, 51966, 4142843, 3392613,
		316844, 1784047, 4213423, 6403661, 6402334, 7644979, 2207387, 5649505, 3417988, 5216205,
		1253114, 8046098, 6615927, 355439, 387443, 4892947, 3815064, 6617490, 3233448, 7000252,
		7486996, 6048222, 7186745, 2752032, 6938845, 4408493, 6893471, 6459907, 5198194, 5185375,
		1094223, 5036500, 1521152, 4024395, 521183, 3812325, 6361249, 4589212, 6367918, 1820338,
		2169683, 3993044, 2738253, 31351, 7792083, 1870695, 4949988, 3365037, 2154908, 4803488,
		4605560, 4683983, 1794968, 7231937, 125372, 33386, 2405954, 413166, 8170391, 802870,
		3830902, 7598667, 5797824, 7265323, 5161793, 3598049, 99336, 5216654, 7486873, 5486853,
		5775104, 8368151, 422949, 1484086, 8034990, 7152237, 4038844, 2902674, 8002439, 6470946,
		4224895, 4536844, 6712821, 5490550, 3167615, 2910987, 6231802, 972083, 5349334, 6917451,
		779309, 6020930, 6753105, 4241250, 6732205, 1930591, 4439090, 2489396, 4350830, 8185144,
		6154074, 7182136, 110922, 6399331, 5212315, 4594763, 6237576, 5676344, 8364935, 2725193,
		1029201, 5179930, 5680212, 5912141, 3151447, 7084159, 386535, 5459951, 2000622, 2002206,
		6358048, 2174534, 7540196, 3827069, 5052715, 2721684, 1106173, 4851116, 2194640, 7298667,
		2613809, 1238032, 5983894, 7163505, 6241571, 7572800, 868824, 6227003, 1667742, 1071664,
		6279939, 5065101, 7402811, 3550421, 7376204, 8356593, 1827084, 3773663, 5728214, 5066955,
		8013418, 8157701, 311750, 101357, 2102600, 6193693, 8188766, 2207844, 877240, 4823119,
		5492095, 44944, 7871804, 56413, 4940590, 1565819, 5300999, 243836, 5939777, 4706756,
		5448151, 2815485, 1837278, 4704397, 7593818, 710939, 7352045, 4011819, 7753405, 5194264,
		452555, 3207273, 6016716, 5415336, 6911650, 3694781, 4402068, 317038, 6502344, 8009749,
		905530, 7690598, 718978, 2936435, 6758531, 6550493, 6915676, 7319049, 4988024, 5871864,
		7892769, 2686897, 7029097, 2627384, 2758040, 5774153, 5787086, 4789376, 2209806, 5465102,
		5769014, 5623332, 332153, 776340, 5732876, 2529673, 1952112, 1370218, 1932093, 8032570,
		6397371, 6443498, 3492578, 849340, 1372155, 2904114, 334192, 5044260, 3937736, 3357277,
		5691014, 7292838, 4724383, 7031319, 5494430, 4274332, 1214256, 4675293, 5971606, 7552197,
		4865068, 7855960, 3911736, 6542339, 1554066, 6623746, 631538, 149890, 1169641, 2751828,
		8069214, 6518660, 8123459, 1882877, 7298144, 6773636, 7579864, 545577, 6534493, 2206251,
		1433627, 4659462, 6661532, 8251647, 7086664, 271090, 2986958, 7102404, 7030537, 1722780,
		1659243, 5533938, 1565727, 4534920, 4931633, 1674900, 4127023, 6726637, 8036213, 7256718,
		2911167, 8130447, 3522876, 4806010, 6066303, 375767, 4090292, 2867599, 3492407, 2533792,
		1048954, 4634706, 1645681, 3556531, 5033868, 5066962, 4531429, 7407065, 3870025, 6050743,
		4621787, 2350794, 7702617, 221956, 494139, 5867745, 348882, 1539320, 3057769, 2283912,
		7425926, 3334575, 6168821, 1598821, 3834447, 506797, 2426084, 6556192, 5084688, 5034910,
		3156148, 8259591, 7208192, 880634, 1048441, 7520903, 676078, 3189565, 4973489, 6802716,
		5435217, 1456875, 6673736, 1387431, 1560222, 3366627, 6490674, 5320794, 5084858, 3601839,
		4902281, 4718708, 7229206, 1034912, 5320068, 841088, 694493, 6940100, 7726772, 1461437,
		259546, 5753620, 6856111, 3080743, 2378882, 6161882, 336813, 2140402, 3682449, 7366625,
		1618071, 5810463, 2604530, 2233038, 116406, 4832424, 301773, 13425, 97634, 65984,
		1272944, 2005871, 3895548, 6395666, 7364365, 4845849, 2837347, 2591074, 750546, 5876447,
		2257957, 4238909, 4911153, 8388112, 104652, 4590814, 4563661, 6779017, 3916284, 4378844,
		461062, 5712351, 7749009, 1662577, 7110541, 1028554, 4760685, 7372983, 3050069, 1689658,
		8398078, 3810723, 1186891, 6253391, 3381791, 7807571, 5700908, 2689186, 7364226, 8076372,
		7389544, 5680014, 7387824, 4700918, 1389189, 6639653, 544749, 4912952, 1822626, 7069399,
		7937225, 1332138, 4336178, 2939034, 2338904, 325165, 146701, 4587787, 7442507, 4347876,
		6427198, 1761884, 4137664, 617338, 6186475, 239342, 3988549, 5623394, 1972010, 1107556,
		1610847, 5714625, 6785547, 582962, 5995097, 7818575, 2850064, 6730950, 8248400, 7784199,
		1272183, 6331963, 7269149, 822304, 5544997, 7293981, 6705351, 986907, 5795677, 5539677,
		2037329, 1200635, 1780643, 6956689, 1623184, 7189620, 2884256, 5382519, 891074, 3019018,
		5451998, 8157324, 5619998, 7414630, 8114824, 8176527, 2867333, 2520659, 1729880, 1444848,
		5982363, 3022187, 350843, 5961903, 1998401, 3709568, 1286086, 2128851, 1463651, 2213858,
		6366809, 4243762, 8032750, 4157775, 7224001, 5838419, 1525494, 5379350, 4912184, 5236045,
		5312884, 1804128, 6768989, 6272686, 7670156, 4308725, 7040902, 5766783, 7289392, 8251446,
		5677537, 7345587, 869976, 7513996, 7779633, 2216272, 5728828, 6185265, 1416683, 7195496,
		4410150, 4092812, 8357888, 3421184, 5397364, 7983055, 6665025, 1055950, 5404480, 5056163,
		230125, 2515551, 3104, 7571714, 1099759, 3345374, 4049739, 4475383, 6389872, 6117121,
		3027904, 2190967, 5369630, 3926154, 2087784, 2671944, 6978853, 3923620, 4574612, 6595564,
		485894, 5729593, 4901487, 7088096, 6155990, 4404243, 4278600, 3090802, 7566859, 1313441,
		6825926, 4108120, 2809349, 8233899, 6435730, 3940482, 5427915, 4293417, 7945891, 4386938,
		5559678, 5408645, 967589, 1394046, 146560, 4014599, 5198125, 6023962, 7920304, 1037912,
		7805834, 7061874, 2857261, 2377575, 1012578, 1708640, 2349929, 3348874, 5969160, 5057514,
		5525650, 6692897, 8349902, 5810512, 7768152, 8314312, 5934871, 5723287, 1082847, 2591025,
		2032195, 2172644, 5502127, 4806620, 3574146, 6979264, 1084779, 6228893, 3748470, 2916865,
		4698106, 3865717, 2565047, 6782582, 4663564, 5484672, 693331, 4358645, 7643252, 5056524,
		2836346, 1013632, 5215641, 4042892, 5166111, 2161462, 4768038, 3762952, 35252, 5924414,
		7433838, 6240075, 5814750, 363290, 3278486, 4304560, 1128088, 4667850, 4965202, 8038247,
		1624362, 1419245, 6838596, 5639237, 2280675, 7058482, 5366704, 6982292, 5051056, 3164885,
		730565, 3719883, 88165, 6884768, 1672121, 5236652, 6609610, 5614902, 8028620, 7818912,
		6194638, 5032277, 1674074, 2786635, 2207645, 2616760, 1995241, 6037042, 4320431, 252265,
		7639038, 5784777, 7083542, 6896734, 2922670, 3828976, 1846049, 2324173, 433968, 1504803,
		97875, 3998335, 126705, 1036112, 2603493, 5034447, 913651, 4403202, 837334, 2840662,
		7613357, 3287031, 7777014, 6127693, 5324318, 5560875, 471459, 4466201, 3824161, 20244,
		1328031, 4486445, 514029, 3935336, 6576914, 5010677, 4607652, 1911148, 5221396, 6921825,
		4794542, 3390860, 8163426, 3328024, 130820, 3724159, 3965136, 7052183, 6786372, 5073513,
		3600911, 1604943, 7441504, 3520481, 273132, 5125424, 8025058, 6796594, 4514923, 4216216,
		2222840, 5109852, 1311251, 924531, 7355171, 4185321, 7192649, 6029292, 7548598, 3576038,
		8227131, 1203793, 3844299, 2372245, 8223422, 4415302, 2235158, 737891, 6301921, 5153193,
		6000207, 3986235, 1335085, 3775028, 4870071, 1925728, 5067109, 5700756, 8164013, 4626509,
		5659819, 5903590, 259380, 7739136, 5640971, 5241189, 2762523, 2497947, 3989177, 5120031,
		1253810, 4455451, 2809088, 1173945, 6400991, 3281506, 3547575, 1555949, 3723422, 1882396,
		3919256, 3438345, 166697, 6845588, 8399816, 4961164, 7587033, 4022974, 4578504, 1423777,
		7412158, 1049296, 7435322, 6748782, 5195832, 5513103, 3631075, 3982730, 2084085, 7580503,
		5751098, 3119565, 2615800, 3009808, 6439031, 1737755, 2264587, 2475909, 1964670, 7982562,
		2103594, 8272761, 1146614, 5974003, 8327401, 8366416, 3799321, 773487, 2152180, 7738894,
		5633297, 684932, 2760026, 2695318, 8368390, 7442395, 578476, 3256333, 799628, 4351117,
		5123688, 3694721, 4811306, 3468539, 6643087, 85577, 6757891, 5570093, 4127120, 1356810,
		478862, 8053829, 5400442, 6916230, 2368774, 6444193, 1111030, 5269030, 1008909, 168238,
		7599578, 4555543, 4333375, 1898872, 8312715, 2289491, 2758827, 2710049, 1118241, 6806087,
		311707, 7346702, 6668827, 3006623, 4330583, 5275571, 3344648, 53224, 5136864, 807070,
		6876821, 6239075, 1302255, 1931622, 4836597, 5960660, 8400286, 5915365, 4397110, 8221039,
		3587303, 3707690, 5864703, 217275, 7221777, 7494503, 91681, 3211008, 8216831, 1968005,
		7968539, 4941460, 2857960, 6284964, 4118821, 5011382, 1919795, 6522856, 2877367, 5626101,
		6977179, 6848942, 5593209, 3742062, 8094839, 7523930, 875102, 1847236, 1976969, 5714676,
		968342};

#elif NIMS_TRI_NTT_MODE == 3
// Q = 8397313
// zeta = 86054 //(2^9*3)th root of unity
// invMONT = 4329369 // 2^(-32) mod Q
// invzeta = 1755596 //zeta^(-1) mod Q
// W = 5661571 //zeta^(2^9) mod Q
#define MONT 3940353	// 2^32 % Q

#define Wmont 1050121		// mont * W (W : 3rd root of unity)
#define W2mont 3406839	// mont * W^2
#define F1 2250740			// mont^2/2^9
#define F2 4501480			// mont^2/2^8
#define F1_woo -8705	   // mont^2/N
#define F2_woo -17410	   // 2 * mont^2/N
#define radix3_len 1	// radix-3 1�뵓怨ㅼ삕
#define radix2_redlen_ntt (N >> 8)
#define radix2_redlen_invntt (N >> 3)
int32_t zetas[511] = {
		4990474, 3227855, 2268138, 972348, 2337085, 124959, 4479337, 3667838, 5689912, 6644273,
		6934194, 6934665, 1538485, 5896473, 152433, 971564, 6152987, 6328434, 6948882, 574790,
		1459554, 5672534, 2982539, 383382, 2182644, 3631088, 6117417, 3514437, 3273452, 4262990,
		2598551, 2624740, 3204729, 7745421, 1375023, 171112, 5348856, 1032490, 4589664, 2395811,
		8343591, 6071282, 7365101, 4401765, 3583379, 2167158, 2285110, 5289144, 3923560, 7953169,
		6722707, 4715825, 6465037, 5854021, 3783550, 5071907, 7765640, 892445, 6144516, 240402,
		349876, 7886275, 4087106, 1235584, 7011869, 7497916, 4385583, 5168591, 6832874, 240718,
		7123460, 3247067, 2567789, 70496, 656034, 1873626, 3512977, 1195040, 413771, 1924321,
		655407, 7136014, 4078101, 476272, 2621588, 3456051, 8154728, 1434739, 7591357, 1545373,
		7524556, 4408881, 395308, 2362032, 2300880, 4839465, 6374899, 4099598, 5945650, 6595643,
		2290135, 5221968, 132753, 7121619, 3771421, 8169963, 4758324, 3398805, 375361, 6746501,
		7808337, 3951210, 7984859, 2721906, 911361, 4486605, 4515839, 6133174, 4398986, 42606,
		5516164, 8006412, 4059425, 6710531, 1783116, 3836780, 8104958, 4584505, 7432834, 3234870,
		6858061, 4934201, 6097734, 4201686, 6901396, 8050176, 383341, 2806294, 6185977, 5867038,
		2614166, 6786110, 2655361, 5533954, 4583186, 4546610, 430326, 3064313, 6284076, 6224373,
		6963213, 7190978, 2271090, 6422994, 8213843, 2771607, 6190754, 6025246, 8046867, 8302794,
		570546, 1327008, 6745812, 547559, 4076162, 5273742, 3184165, 4293535, 1289247, 6071198,
		2375675, 1099499, 7458138, 2985263, 1376941, 1651505, 3963832, 7439099, 2260402, 8373167,
		4117372, 3162151, 1919551, 621337, 1739534, 355419, 907301, 4746577, 7254367, 8041444,
		4753267, 8285032, 6005209, 3191271, 1740753, 4591869, 8178904, 264532, 2479834, 5802854,
		6196469, 1672317, 2149662, 117314, 3237267, 8013170, 370, 8179771, 4319762, 2114157,
		4927297, 4393190, 2283578, 4205126, 7295526, 6246517, 1493570, 2939653, 5769134, 6845391,
		8348858, 6241339, 5831293, 1416315, 4894611, 7795494, 8356971, 1904796, 2739086, 1298122,
		1629867, 1421572, 2250284, 4222267, 3962274, 389160, 7092123, 3024641, 3496326, 6075004,
		517124, 6618785, 8114979, 7703944, 1138889, 1240465, 28163, 1844240, 4686552, 2160386,
		5512594, 7760014, 6244796, 7519805, 7161983, 8035435, 7116149, 5255994, 1053086, 5380821,
		2490361, 3078953, 149966, 2662323, 6070477, 6586811, 7917965, 4318848, 2309794, 4944749,
		6427458, 7066165, 1665386, 3238601, 5942938, 7455976, 1240339, 2153217, 7351999, 7424505,
		5128736, 1964008, 4933934, 7542235, 5484370, 4126028, 4335755, 2123869, 8383463, 6596552,
		5299166, 1587176, 4331708, 2144326, 7675927, 7611731, 1924818, 4287429, 6887651, 2501720,
		534250, 1586814, 823900, 1723218, 731520, 5445059, 915930, 7412321, 1194060, 4420009,
		5185427, 5793152, 935050, 1434946, 1292678, 6436655, 3310160, 6291589, 3533008, 7920168,
		1306171, 2403825, 913285, 6464803, 578918, 8124486, 4454472, 4880977, 4491304, 605859,
		1284361, 1368247, 1242552, 7739441, 6060253, 5769475, 3519455, 1997286, 8209646, 210912,
		144531, 6115752, 7236238, 2474096, 4399603, 4172254, 2943434, 5812702, 6934208, 8172729,
		5905199, 4419443, 1556603, 1645864, 5392445, 2845077, 2354190, 432934, 1610786, 2080041,
		3459615, 6330916, 5622139, 7777805, 3132481, 5691738, 7623872, 2107815, 6104719, 747509,
		8091014, 2992206, 1708614, 5120584, 1405816, 4056285, 4620372, 6172929, 3119643, 4697378,
		5401179, 6573747, 3296606, 168330, 2051998, 1324483, 4918636, 5849556, 7885623, 6972914,
		6775153, 2513543, 1620324, 3602798, 7611850, 4602204, 2454758, 4477162, 2042514, 506974,
		4039870, 3843692, 4795871, 6223248, 4320007, 7775546, 310528, 7734180, 6067756, 5679474,
		1336594, 2846921, 319669, 5340563, 8081606, 3320228, 4969396, 4516760, 6432898, 2805090,
		1849375, 38833, 3936574, 3608060, 8263553, 3265463, 3601393, 613565, 751432, 7449517,
		866476, 838550, 7268449, 4201000, 8140982, 7056512, 3513122, 7116264, 594751, 7541803,
		6216020, 5034645, 6572193, 4971789, 3862199, 8261442, 7159345, 3078089, 1613266, 4307595,
		7489368, 4734398, 6615721, 7318498, 7117080, 4183258, 1567826, 4814237, 2605671, 1768730,
		7312956, 3179559, 6648041, 5648722, 547264, 3880333, 8090729, 4541000, 5499699, 2503695,
		882585, 576849, 6797315, 8242450, 7912676, 1770164, 3717991, 46826, 7854881, 970128,
		32227, 5694358, 4897114, 8162537, 5128047, 7533062, 4653092, 8298417, 3901556, 8025534,
		5029744, 290396, 5638428, 7740179, 5510127, 3673401, 3227109, 8375539, 5853786, 4130252,
		913983, 332254, 5112658, 3410573, 7191670, 1744337, 8155393, 723057, 3629549, 3962377,
		4894760};

int32_t zetas_inv[511] = {
		3502553, 4434936, 4767764, 7674256, 241920, 6652976, 1205643, 4986740, 3284655, 8065059,
		7483330, 4267061, 2543527, 21774, 5170204, 4723912, 2887186, 657134, 2758885, 8106917,
		3367569, 371779, 4495757, 98896, 3744221, 864251, 3269266, 234776, 3500199, 2702955,
		8365086, 7427185, 542432, 8350487, 4679322, 6627149, 484637, 154863, 1599998, 7820464,
		7514728, 5893618, 2897614, 3856313, 306584, 4516980, 7850049, 2748591, 1749272, 5217754,
		1084357, 6628583, 5791642, 3583076, 6829487, 4214055, 1280233, 1078815, 1781592, 3662915,
		907945, 4089718, 6784047, 5319224, 1237968, 135871, 4535114, 3425524, 1825120, 3362668,
		2181293, 855510, 7802562, 1281049, 4884191, 1340801, 256331, 4196313, 1128864, 7558763,
		7530837, 947796, 7645881, 7783748, 4795920, 5131850, 133760, 4789253, 4460739, 8358480,
		6547938, 5592223, 1964415, 3880553, 3427917, 5077085, 315707, 3056750, 8077644, 5550392,
		7060719, 2717839, 2329557, 663133, 8086785, 621767, 4077306, 2174065, 3601442, 4553621,
		4357443, 7890339, 6354799, 3920151, 5942555, 3795109, 785463, 4794515, 6776989, 5883770,
		1622160, 1424399, 511690, 2547757, 3478677, 7072830, 6345315, 8228983, 5100707, 1823566,
		2996134, 3699935, 5277670, 2224384, 3776941, 4341028, 6991497, 3276729, 6688699, 5405107,
		306299, 7649804, 2292594, 6289498, 773441, 2705575, 5264832, 619508, 2775174, 2066397,
		4937698, 6317272, 6786527, 7964379, 6043123, 5552236, 3004868, 6751449, 6840710, 3977870,
		2492114, 224584, 1463105, 2584611, 5453879, 4225059, 3997710, 5923217, 1161075, 2281561,
		8252782, 8186401, 187667, 6400027, 4877858, 2627838, 2337060, 657872, 7154761, 7029066,
		7112952, 7791454, 3906009, 3516336, 3942841, 272827, 7818395, 1932510, 7484028, 5993488,
		7091142, 477145, 4864305, 2105724, 5087153, 1960658, 7104635, 6962367, 7462263, 2604161,
		3211886, 3977304, 7203253, 984992, 7481383, 2952254, 7665793, 6674095, 7573413, 6810499,
		7863063, 5895593, 1509662, 4109884, 6472495, 785582, 721386, 6252987, 4065605, 6810137,
		3098147, 1800761, 13850, 6273444, 4061558, 4271285, 2912943, 855078, 3463379, 6433305,
		3268577, 972808, 1045314, 6244096, 7156974, 941337, 2454375, 5158712, 6731927, 1331148,
		1969855, 3452564, 6087519, 4078465, 479348, 1810502, 2326836, 5734990, 8247347, 5318360,
		5906952, 3016492, 7344227, 3141319, 1281164, 361878, 1235330, 877508, 2152517, 637299,
		2884719, 6236927, 3710761, 6553073, 8369150, 7156848, 7258424, 693369, 282334, 1778528,
		7880189, 2322309, 4900987, 5372672, 1305190, 8008153, 4435039, 4175046, 6147029, 6975741,
		6767446, 7099191, 5658227, 6492517, 40342, 601819, 3502702, 6980998, 2566020, 2155974,
		48455, 1551922, 2628179, 5457660, 6903743, 2150796, 1101787, 4192187, 6113735, 4004123,
		3470016, 6283156, 4077551, 217542, 8396943, 384143, 5160046, 8279999, 6247651, 6724996,
		2200844, 2594459, 5917479, 8132781, 218409, 3805444, 6656560, 5206042, 2392104, 112281,
		3644046, 355869, 1142946, 3650736, 7490012, 8041894, 6657779, 7775976, 6477762, 5235162,
		4279941, 24146, 6136911, 958214, 4433481, 6745808, 7020372, 5412050, 939175, 7297814,
		6021638, 2326115, 7108066, 4103778, 5213148, 3123571, 4321151, 7849754, 1651501, 7070305,
		7826767, 94519, 350446, 2372067, 2206559, 5625706, 183470, 1974319, 6126223, 1206335,
		1434100, 2172940, 2113237, 5333000, 7966987, 3850703, 3814127, 2863359, 5741952, 1611203,
		5783147, 2530275, 2211336, 5591019, 8013972, 347137, 1495917, 4195627, 2299579, 3463112,
		1539252, 5162443, 964479, 3812808, 292355, 4560533, 6614197, 1686782, 4337888, 390901,
		2881149, 8354707, 3998327, 2264139, 3881474, 3910708, 7485952, 5675407, 412454, 4446103,
		588976, 1650812, 8021952, 4998508, 3638989, 227350, 4625892, 1275694, 8264560, 3175345,
		6107178, 1801670, 2451663, 4297715, 2022414, 3557848, 6096433, 6035281, 8002005, 3988432,
		872757, 6851940, 805956, 6962574, 242585, 4941262, 5775725, 7921041, 4319212, 1261299,
		7741906, 6472992, 7983542, 7202273, 4884336, 6523687, 7741279, 8326817, 5829524, 5150246,
		1273853, 8156595, 1564439, 3228722, 4011730, 899397, 1385444, 7161729, 4310207, 511038,
		8047437, 8156911, 2252797, 7504868, 631673, 3325406, 4613763, 2543292, 1932276, 3681488,
		1674606, 444144, 4473753, 3108169, 6112203, 6230155, 4813934, 3995548, 1032212, 2326031,
		53722, 6001502, 3807649, 7364823, 3048457, 8226201, 7022290, 651892, 5192584, 5772573,
		5798762, 4134323, 5123861, 4882876, 2279896, 4766225, 6214669, 8013931, 5414774, 2724779,
		6937759, 7822523, 1448431, 2068879, 2244326, 7425749, 8244880, 2500840, 6858828, 1462648,
		1463119, 1753040, 2707401, 4729475, 3917976, 8272354, 6060228, 7424965, 6129175, 5169458,
		3584677};
#elif NIMS_TRI_NTT_MODE == 5
// Q = 8404993
// zeta = 4184677 //(2^8*3^3)th root of unity
// invMONT = 7896129
// invzeta = 1554873
// W = 6999551
#define MONT 15873	// 2^32 % Q

#define Wmont 6675549		// mont * W (W : 3rd root of unity)
#define W2mont 1713571	// mont * W^2
#define F1 6642923			// mont^2/N
#define F2 4880853			// 2 * mont^2/N
#define F1_woo 930247	   // mont^2/N
#define F2_woo 1860494	   // 2 * mont^2/N
#define radix3_len 3	// radix-3 2�뵓怨ㅼ삕
#define radix2_redlen_ntt (N >> 8)
#define radix2_redlen_invntt (N >> 3)
int32_t zetas[2303] = {
		6691422, 3745396, 1005959, 5560684, 557530, 1359546, 5166674, 5884035, 4422884, 4240425,
		5387571, 1046739, 2694230, 3252563, 6563702, 6365869, 2241533, 6130832, 3005748, 2818295,
		1059740, 1575156, 6639601, 1563110, 7206912, 1200488, 285221, 8040721, 2282474, 6468071,
		4739225, 2021449, 3517630, 7346728, 4905548, 5238671, 3440514, 4703105, 940539, 2892723,
		6587485, 4244468, 3541424, 3284715, 964913, 106719, 2439163, 2652420, 2954142, 8379323,
		7950516, 8059860, 1193423, 7129183, 7731829, 264713, 8060094, 445982, 8011185, 1369059,
		7955478, 5679661, 6136964, 5113226, 3683432, 7938303, 6949595, 5152479, 1033092, 1728878,
		8278066, 3908887, 4478964, 1661123, 751008, 3037667, 1719154, 4320384, 7339862, 4426392,
		7097598, 7116055, 3331941, 1686410, 6321919, 1086929, 6201985, 1269346, 4028114, 1093944,
		3364626, 7532885, 7083882, 6208581, 6588778, 2989190, 4018245, 905487, 7903618, 6818581,
		2510402, 3495458, 8269219, 5100927, 4821549, 7197271, 7365006, 7566618, 5426137, 1390757,
		4282185, 3438679, 4615431, 4943292, 483603, 8193371, 1190228, 2472636, 7326792, 4641031,
		6575361, 6820008, 586507, 8339833, 1302054, 7839232, 2038881, 7951916, 2149249, 4851479,
		6738222, 7925831, 1335443, 8252838, 2533493, 351317, 69907, 2530659, 67928, 4628830,
		6097080, 6520199, 7059579, 3741732, 5872664, 1844725, 3046182, 6710463, 1533306, 777419,
		8184245, 87056, 7368142, 4291236, 613216, 4955376, 1690952, 4474239, 6784644, 2909821,
		7943851, 948115, 3618608, 3420707, 4466850, 8249857, 4873863, 2031465, 2812877, 7672067,
		1196093, 1679678, 6892943, 280851, 4838437, 286108, 2180160, 5946783, 3280475, 2953005,
		5294676, 1176, 5818203, 7589923, 6465761, 5542137, 6290777, 4603252, 7727308, 625905,
		6148742, 4934225, 8349238, 6933212, 7729342, 3845758, 1099113, 6380048, 1313510, 1844170,
		4995993, 8090989, 460717, 2321474, 6689731, 6053013, 577288, 3209389, 3044372, 2313948,
		1145465, 7998760, 2770361, 5631248, 2577595, 7779883, 3552194, 226028, 4944063, 4270717,
		4051664, 4953682, 4416567, 1351657, 806825, 574573, 304984, 6607630, 5841098, 6844990,
		5184478, 5421164, 4815963, 7879235, 7430274, 6207605, 3475370, 459765, 7611163, 7678294,
		5352327, 7606168, 278548, 675466, 7583149, 70338, 6948390, 4509876, 7342567, 3044034,
		3566248, 4994119, 2649626, 7118134, 2661184,
		5187630, 5567006, 3283020, 3077132, 7100721, 239145, 7205603, 2837987, 6533880, 5628597,
		1525979, 3521817, 7068951, 745421, 2338364, 2776396, 433795, 5317839, 8103639, 7215594,
		1761601, 4128440, 7301990, 3087154, 1918808, 3078610, 4189694, 6955843, 4221177, 1629460,
		7060028, 5326383, 6623753, 5696947, 561790, 2226114, 1845714, 7923061, 7669702, 2708046,
		1693494, 5397589, 3206900, 3797749, 2675293, 790345, 7149337, 3007404, 2084479, 3675838,
		6894862, 2267012, 1037511, 5942850, 4928233, 4729155, 3877418, 1560352, 4245121, 4513011,
		4840800, 6073363, 4816015, 6844641, 3496258, 7711960, 1502833, 5071781, 1065441, 4378748,
		2278413, 693033, 3998155, 3138798, 3918781, 4062299, 5597631, 7201097, 577673, 5266195,
		6348454, 7651632, 1615887, 3007373, 7290967, 2254012, 7314433, 753361, 2928390, 4116231,
		1957313, 7537819, 1910632, 3249057, 5449879, 4288762, 5471251, 4682175, 5899177, 4178133,
		7561898, 455315, 1176741, 3722818, 6347835, 5794072, 5869587, 4163177, 7736376, 1552256,
		6717711, 2610921, 3017256, 2194791, 4233387, 6193357, 4377683, 8388148, 5777692, 6210202,
		432750, 7666377, 5915709, 6477821, 1019926, 5739205, 523805, 738616, 7006888, 7147319,
		1205793, 1024022, 4810963, 8171341, 6449055, 1257674, 4099298, 8043782, 7046327, 7938055,
		6603656, 7576844, 4933087, 361211, 4164473, 2064455, 5042866, 7464427, 5085005, 1123889,
		6985765, 6340538, 5398894, 8059407, 7383307, 1748521, 3983219, 1402935, 8318036, 345586,
		4994580, 6214078, 2089037, 1153908, 7662488, 7367986, 8253804, 2190915, 1600644, 3489556,
		2482432, 3686699, 2246699, 7176255, 1690967, 4915437, 5879116, 7244355, 4633305, 1970528,
		1979224, 809890, 305524, 1160638, 6986220, 7904390, 1204573, 3327482, 7394476, 2826879,
		5140808, 500603, 2443041, 6362966, 7324321, 6816133, 6911327, 4774106, 3170047, 2042027,
		8043159, 338314, 642322, 6559208, 8171543, 6897522, 2894702, 8066679, 3150419, 8072119,
		5472635, 4784935, 5548711, 4452061, 1908653, 332874, 7898754, 3952911, 6388949, 3966429,
		3887702, 7919340, 7277837, 4452082, 7987800, 2124377, 7835433, 193770, 1174089, 2318147,
		5837469, 6280616, 6712164, 8120925, 3534051, 3930556, 6201675, 3646488, 7097227, 284068,
		6346292, 5669951, 5976856, 3399944, 6198884, 664902, 4551327, 2735042, 4637472, 1278047,
		561663, 1717263, 8129046, 2995310, 4040621, 7126946, 3955830, 6139634, 7073645, 2525292,
		7850887, 259933, 7069324, 2265359, 4581463, 5065177, 5147187, 6452941, 227895, 3113125,
		4496549, 3339816, 167912, 6830473, 4984262, 4765821, 4600007, 3191301, 6532576, 1574520,
		5328189, 5677633, 6856973, 7210505, 7770178, 4483145, 5021465, 2727360, 6938462, 2034494,
		8386746, 6897259, 8003572, 526760, 5186522, 6370499, 2916807, 8028648, 708975, 4860000,
		767639, 4483655, 1982674, 376345, 4471806, 5028201, 7639276, 6004614, 5565476, 2627822,
		7290660, 3376792, 2905059, 3212995, 4423591, 5230376, 4373588, 38378, 3638382, 5191998,
		834406, 4282023, 6650272, 8118694, 8282850, 3995724, 1203031, 4122970, 7078619, 6234113,
		5408457, 8254981, 1752194, 6084101, 7231488, 2170880, 6269352, 4882749, 1967458, 4114652,
		7330106, 592408, 2033326, 3522244, 2254675, 2167372, 4154213, 5114650, 7700925, 7282022,
		6208098, 6237621, 3410547, 2670958, 2896708, 3445189, 3049450, 6116147, 1543152, 5734035,
		7172708, 1899663, 4625077, 5075383, 3502520, 6975046, 658962, 6505330, 133956, 4890573,
		4588604, 1667288, 7484634, 6557861, 7065598, 3514420, 2181784, 7277985, 8099460, 6636700,
		7724559, 5509692, 6547840, 1127008, 5162778, 4174789, 151844, 951646, 6272327, 5126435,
		6466997, 4230204, 62725, 1789817, 3684852, 4345891, 7359327, 6135708, 437663, 6615176,
		7613492, 5656764, 7133391, 3954033, 3588951, 1205804, 4351720, 2748229, 4046305, 6516893,
		533274, 7460226, 6593856, 5572126, 2471360, 1888100, 421707, 4616032, 2178601, 5105759,
		1144927, 1316798, 157050, 3788961, 3940319, 432545, 4317154, 7828807, 6574256, 8261352,
		5952899, 7972448, 264222, 6096395, 968824, 4332540, 3502978, 2023942, 4151445, 2308598,
		8019193, 2246053, 4634377, 8025549, 894087, 1866609, 1951098, 6158940, 7327274, 5635671,
		6680549, 4531828, 6150636, 1762506, 2785171, 2769322, 7568212, 1720879, 2894875, 8352176,
		6841511, 1668062, 5550621, 6684114, 8020815, 7345500, 2762178, 2186047, 718176, 1126554,
		1613754, 1059493, 2943865, 4930522, 4879722, 1018070, 7585393, 5948592, 3557943, 3474471,
		2366377, 1687941, 2042885, 6099328, 5141860, 7787269, 6906161, 6717052, 1150270, 4484909,
		4949529, 3000607, 6413093, 7485516, 4884425, 3920084, 7998805, 2324488, 6144348, 3665474,
		1022118, 5989962, 4429564, 6080505, 2654400, 5492721, 3982608, 7918049, 3861250, 5005777,
		314137, 2912272, 7123335, 2138750, 1307768, 1405381, 56522, 5496949, 2803881, 3273713,
		3841362, 5379076, 4698559, 276591, 2124750, 8128402, 1573250, 365669, 926563, 6266243,
		2965391, 7517826, 7603213, 1681972, 8265246, 5131280, 1076883, 2510840, 7454905, 719370,
		6838166, 2017962, 6883480, 4528273, 8379093, 4724763, 8200884, 3796430, 6258932, 4608563,
		3043161, 6546235, 197274, 5894153, 1661017, 7235603, 5164872, 4515800, 6713958, 3876720,
		3053345, 3284897, 1708002, 2889477, 5987846, 7928632, 3776738, 2437214, 7405893, 4370531,
		3581890, 6109011, 2887591, 2295982, 2836279, 1960853, 4883958, 5120096, 5661133, 7655428,
		3682426, 593495, 4831078, 5967779, 5928489, 3218336, 4579567, 6368024, 4815956, 90881,
		5969652, 5609893, 5417020, 4423403, 5480542, 309582, 1978525, 8095411, 1207855, 5700774,
		37923, 5186657, 2516353, 7641739, 7729595, 6677606, 4307141, 2795100, 220591, 640958,
		2490308, 964338, 6124052, 1289973, 1289222, 7143007, 7341160, 1046318, 1004253, 803840,
		4968594, 7601153, 6826739, 27987, 965528, 7764035, 7483526, 1687276, 4184278, 1768178,
		6392363, 1261986, 1195165, 4141818, 3173353, 4012934, 4080321, 2597113, 3427919, 2351765,
		3958285, 3053419, 6236896, 6036004, 6565165, 2368989, 3435061, 4948878, 1630666, 4263175,
		233076, 7195237, 7227670, 1643945, 1982341, 6053228, 1385379, 3849778, 6300791, 5455581,
		7245500, 2815114, 1906899, 2685377, 7016262, 7311930, 1356060, 2622406, 4575684, 5782587,
		4616282, 5500491, 1731939, 4555215, 3409280, 2756715, 7967488, 8077987, 2966254, 5719616,
		3542387, 6821894, 8143183, 833038, 6448849, 1482126, 1059673, 6017397, 6030946, 887784,
		4724656, 3717125, 308157, 4687868, 6698800, 7499523, 2685500, 1583099, 1954392, 7709678,
		4402060, 4550163, 688220, 2387596, 4775139, 6917896, 82329, 2884498, 2051694, 826626,
		2350266, 2319634, 654376, 997529, 2986542, 2445560, 1535266, 5959433, 4324123, 3146260,
		3929613, 1487097, 6303576, 7915425, 4020654, 5330058, 6080344, 6085359, 5801151, 335479,
		6137798, 8199468, 2134627, 7769572, 7833721, 590575, 3947129, 7020596, 316758, 7477612,
		1458408, 927381, 198719, 8360147, 3887307, 8069514, 4594806, 7356075, 2434996, 7272087,
		1682318, 7814418, 286150, 5212041, 7950325, 6516880, 7445307, 3827543, 8240463, 5431617,
		3567907, 7437147, 2645777, 515993, 5147067, 7889000, 6205316, 854167, 1487418, 3192952,
		6679782, 4244195, 1118784, 7032873, 122290, 2973376, 8403952, 5342346, 3734452, 6813007,
		4020, 7770593, 1721544, 6697026, 595299, 7709814, 4760469, 1231240, 7456006, 7173753,
		2234481, 6062626, 7564399, 3062647, 8108525, 4647167, 7329055, 8044247, 1968406, 1707967,
		6792039, 2905847, 4975695, 6315216, 7754677, 7294932, 2734127, 1153766, 1020684, 3489312,
		874428, 2802528, 923239, 5602465, 8247009, 43705, 2030009, 5499146, 1845114, 6395159,
		4875941, 712751, 2490863, 7251227, 6904101, 436055, 1151372, 5049782, 8218140, 2008432,
		2952259, 8234385, 5655169, 53285, 2672259, 375556, 1275616, 8029437, 4695563, 1837824,
		7596703, 7968938, 5734707, 489340, 7195223, 5425338, 3190534, 170608, 2560193, 2134780,
		182827, 2002037, 8304009, 1255109, 7961863, 552180, 2508166, 4068464, 4884289, 1026249,
		1308532, 7378744, 3556943, 1807289, 4030085, 6270213, 1584807, 6203244, 6780739, 3028286,
		6184712, 7852813, 4882442, 1459264, 3706138, 3762892, 7595908, 704511, 6272386, 6848979,
		3408152, 8237228, 775088, 4402245, 3798532, 4002748, 4617399, 7553490, 7542783, 6945729,
		3718955, 1291499, 3601184, 8165137, 4822348, 1556014, 2868962, 5762218, 8101442, 1558317,
		256852, 2120844, 4544227, 8014656, 4089620, 8119927, 2386297, 6889861, 1061026, 1515132,
		7862474, 1730507, 1061927, 2642775, 2199724, 5477152, 4415594, 43185, 2695898, 390337,
		1220102, 579728, 98416, 2460326, 5316226, 1011326, 3559563, 7468522, 5296878, 5941644,
		3088345, 2246080, 861518, 6158913, 5739839, 74855, 4569434, 7825265, 4218374, 6521372,
		2167149, 4706406, 6357485, 936471, 1114166, 3601159, 64479, 7214988, 4296225, 2003667,
		6920201, 1682448, 6048652, 6122539, 1204287, 7070112, 2339278, 1334881, 7429373, 3686115,
		2423427, 4803834, 5561365, 1318705, 5065261, 5880107, 2600386, 6722545, 2960884, 137000,
		4676572, 8287716, 1016086, 913101, 8009340, 1631329, 6289421, 4430637, 8067790, 4108704,
		7130109, 4296289, 3190779, 2544430, 7418037, 8267993, 200210, 4567637, 6241097, 3991427,
		7171632, 6773664, 2585818, 2780826, 7873001, 5368915, 3627118, 1841808, 76719, 7948167,
		3477546, 6874929, 406171, 1500222, 6550595, 6904771, 5789815, 1384982, 2825359, 5624167,
		6500772, 1250762, 1535099, 6869137, 159577, 456826, 4767061, 1325706, 2521994, 4302871,
		1792226, 5692079, 2556701, 459446, 7066224, 7551195, 6258634, 7269476, 1292506, 1135517,
		7953767, 6151525, 2687103, 7079287, 2339794, 471908, 4996965, 3167354, 6393823, 7945547,
		6769323, 5942610, 1229586, 4010547, 6146867, 1952340, 1400157, 4667160, 4855026, 5835515,
		6413332, 7233851, 4945626, 1171142, 5050410, 6619500, 3282636, 2462383, 3417454, 3373132,
		775053, 2839405, 5332655, 3737833, 5473969, 3830427, 5398103, 1267257, 8194029, 5109907,
		5271973, 1320158, 1777361, 5462724, 1223069, 3829071, 5945015, 4575922, 4145792, 6430065,
		5575682, 4574566, 3297810, 888158, 2094713, 5096328, 2888055, 7084835, 3398406, 5362736,
		3845450, 6225608, 5430434, 5315668, 6128178, 4076601, 4220099, 3368571, 290431, 1234152,
		4284267, 7170841, 7551265, 987276, 6078806, 3042257, 2837528, 326314, 2058495, 7459760,
		1153340, 4328392, 6887926, 1116437, 3644378, 5546993, 190494, 5514068, 4026319, 7928226,
		3157279, 7073044, 2448537, 7081300, 8233115, 1323693, 5237729, 5037301, 4224353, 7288556,
		6198651, 8189481, 4889378, 4223300, 720722, 476767, 4142954, 457268, 2143940, 5452302,
		7932492, 454032, 5746488, 8119552, 7562931, 7327303, 407967, 5130560, 4955017, 3274433,
		7823426, 168591, 5305231, 7947725, 7506900, 7784571, 6522625, 2177869, 6156769, 285441,
		769120, 4666753, 8215964, 5570646, 2818941, 2734099, 4931505, 3322933, 4962817, 2427710,
		4088045, 5908989, 374951, 2496004, 7575010, 6057032, 4583311, 3738240, 7953248, 7094463,
		4742723, 3074642, 5183998, 5082060, 3410505, 5145337, 2127721, 815886, 4899274, 3268115,
		6223732, 7454054, 3090279, 6748393, 914530, 4338385, 1967591, 4066608, 6360043, 2317176,
		2235894, 3259656, 2577273, 3488737, 2089292, 5154271, 2836572, 950939, 2219476, 6469601,
		5714851, 2363031, 1238975, 2888804, 3077175, 3308921, 2483174, 6938646, 1051446, 3894353,
		5300985, 4510640, 6206544, 6197725, 4429432, 1935392, 413620, 5003254, 6160780, 6257384,
		5669300, 5096072, 4974429, 5812317, 40015, 7129659, 7943119, 1218973, 5706061, 4908903,
		6709211, 5507530, 7491541, 1185413, 7407794, 7219580, 7000082, 6127876, 3221086, 2592676,
		2650310, 2914854, 5396981, 8315072, 1755205, 3496090, 4019854, 5872648, 6463460, 8228884,
		5283241, 8285746, 6996581, 937493, 569126, 3355612, 3888624, 751314, 7111435, 7653679,
		2804122, 818246, 490026, 2532345, 6400065, 823267, 2653192, 575205, 5949954, 7467500,
		4419272, 609825, 2363371, 1375226, 7616321, 2682550, 913830, 5284484, 3213265, 278546,
		7492045, 3405395, 7315705, 4999598, 6260406, 7967034, 3261819, 7795168, 4111973, 888371,
		2566023, 4780621, 1173116, 3120509, 3553115, 2259373, 2333198, 7213042, 255063, 7097777,
		3301396, 7242635, 7017340, 5457520, 2268660, 2032526, 1125823, 6372467, 1668269, 5935419,
		8247820, 6145620, 2490560, 7716893, 4154272, 840575, 3195651, 1162358, 343384, 3658352,
		1637781, 1955976, 3348787, 6035139, 7183623, 7030454, 340723, 1626292, 3626545, 1834125,
		982111, 6570868, 5940881, 4660600, 6041494, 4746641, 1736951, 5284644, 2504481, 3790101,
		4337644, 1374539, 6950031, 7609615, 3950454, 310194, 6078801, 376555, 4215311, 5451510,
		4096279, 1983069, 6635754, 7311162, 2961805, 1093831, 2680586, 5828065, 479648, 795378,
		3385844, 1187691, 6247182, 7621356, 6568929, 2953483, 2112047, 8297137, 3075932, 7271297,
		6062213, 5710165, 6193997, 2566540, 310111, 1303597, 8368587, 1045629, 1081993, 7359364,
		2066004, 8276705, 2894488, 107856, 1581710, 1195741, 4439605, 8316926, 988967, 5838453,
		6865201, 6897144, 7172898, 5507933, 6527496, 311869, 793704, 1499272, 2830604, 1404203,
		6551063, 2231544, 2510101, 6173449, 4167752, 1811141, 6826138, 1507849, 4668027, 8301347,
		3637370, 7739477, 2537991, 6905721, 637742, 2067583, 6665935, 977770, 1824523, 8214005,
		7154775, 7895733, 8104291, 7053190, 5070150, 521174, 1452296, 7883819, 5815323, 7704745,
		4225794, 6337410, 5837260, 715780, 2587542, 1498944, 5870687, 509260, 978845, 1071332,
		7589002, 5042961, 5279006, 4384295, 5684755, 7885928, 3548609, 672255, 7937146, 5203418,
		6386271, 3201575, 1610526, 3865230, 1061958, 7333661, 3743461, 1743587, 5229322, 1841386,
		7367899, 519065, 8096703, 2930807, 1811911, 7793251, 3588481, 1466137, 2673938, 967537,
		6016740, 6097774, 2366396, 4356008, 611502, 4048985, 5784151, 2433674, 5874020, 5474186,
		167415, 623588, 5766847, 3744266, 1049030, 7437456, 2723088, 5629000, 1390285, 6408478,
		505285, 2792843, 2497407, 2302798, 6800798, 263222, 4016976, 4336559, 6072751, 4068434,
		2144811, 5095641, 8061699, 2775993, 412224, 5892222, 7333617, 2340044, 3397834, 6102195,
		6552967, 8359348, 1123779, 5505080, 5504828, 5724366, 4467406, 7780799, 4611268, 4493514,
		2368070, 2775909, 7810093, 5629084, 3327370, 5100172, 8110560, 45645, 2920976, 4447869,
		1767232, 8280989, 6620121, 624194, 3274096, 4338428, 7483684, 3617019, 7218460, 7541292,
		6133565, 1911891, 1318, 1651667, 5840661, 5853855, 1801241, 2551138, 8278041, 1048190,
		8013322, 4066565, 5737960, 5990095, 3914354, 1065881, 2354428, 6493102, 7540957, 2263243,
		5804160, 3371040, 5831477, 4203909, 1568611, 5809561, 6636229, 4427451, 2686639, 899497,
		4318191, 7505496, 6938518, 1608477, 3622502, 6141750, 1211043, 6690694, 5403300, 4270537,
		5326987, 2595432, 1147738, 1430521, 5671898, 7773611, 2519493, 1178652, 2944985, 2585148,
		8214102, 2055283, 4298993, 5239876, 6057592, 3165117, 6168458, 3763800, 3421193, 6974472,
		1961831, 3485804, 5756481, 4608494, 1894809, 5819845, 983744, 4776312, 914324, 5995331,
		6422738, 3564737, 8168042, 4521556, 1982417, 3079392, 2537893, 7946121, 7582299, 458872,
		3908318, 8086293, 706342, 3628681, 584941, 7855704, 6611016, 5536459, 4717052, 3883437,
		7919056, 2531920, 5315714, 7395871, 7011568, 3412460, 2160136, 4519158, 8077002, 5607728,
		6918050, 3923104, 2745579, 4481889, 2092273, 7931618, 7418556, 5873073, 6795210, 8139648,
		8205940, 2913982, 4593587, 3885835, 5081858, 5335292, 2678934, 3812512, 3119881, 2329536,
		2589239, 3267107, 477281, 3805942, 174400, 2597126, 3221793, 5807867, 2735629, 5596643,
		4756030, 3069701, 1482220, 736241, 7118156, 6409638, 6435538, 5137886, 7527237, 4195569,
		5650605, 6736213, 991639, 727916, 375157, 4052982, 8232807, 3217561, 174133, 2229075,
		2420073, 6175918, 1726649, 4780898, 2983411, 4209424, 3859759, 7413130, 3915096, 560295,
		3091737, 4352011, 5601588, 1016095, 5512376, 3851399, 4697693, 2421586, 2918981, 4458901,
		3353002, 4556661, 8274913, 6843551, 2555131, 1561442, 3195343, 6880487, 693664, 7388898,
		976425, 5572756, 6226430, 2289957, 5748567, 3946092, 8396540, 353452, 5771123, 2631695,
		177974, 5315041, 7947821, 5389359, 3937664, 4015495, 5059624, 6535390, 5543522, 1869603,
		8188964, 2299407, 7344113, 8051541, 6829268, 4368947, 7613071, 762092, 2451650, 3015634,
		7313662, 3207212, 1817568, 718839, 8065641, 82262, 1774201, 3708827, 7779373, 5273231,
		2910037, 2041755, 7625955, 6363238, 6871858, 3791089, 2766170, 5197781, 4009955, 75450,
		7127620, 2760594, 1567076, 4696166, 2289253, 1335315, 3019244, 5331527, 5305236, 1816635,
		6129117, 5397411, 4484841, 1077775, 674355, 149482, 507868, 8255511, 697451, 7214046,
		218750, 7069678, 2603546, 2413090, 7115744, 5481009, 6077734, 3007582, 1500272, 3059070,
		5029038, 2671562, 237691, 6953507, 4467637, 6320697, 3972, 1775399, 2972725, 3462514,
		5377306, 4942479, 1721847, 4869211, 5030915, 5345923, 903145, 4834469, 6018885, 6134076,
		2810040, 2084296, 5872427, 4763944, 6800749, 7714402, 6267765, 4217036, 1188585, 6073933,
		440987, 4060524, 5704375, 2219561, 453984, 6185432, 7506945, 1885976, 3769452, 3641049,
		3424947, 419475, 506665, 1528970, 895337, 2331060, 5045022, 3411882, 7375821, 8067023,
		500835, 3581986, 1595299, 6973553, 4950070, 5939523, 64503, 5863331, 3673436, 2541662,
		1992100, 2150546, 8364969, 4993111, 3207541, 946412, 3004946, 5525361, 8202130, 1431440,
		2252566, 5330183, 1214956, 5939545, 965861, 7922106, 4816104, 376611, 1266753, 6345098,
		997291, 1753836, 5406836, 6651157, 3969814, 8298717, 169391, 3074810, 6204090, 3270288,
		7201589, 7693381, 4260335, 8028382, 3038166, 4397426, 3219729, 5666045, 4060268, 7573404,
		2041022, 7025866, 317605, 7045489, 8225795, 4595967, 4092037, 3809026, 3372081, 6194277,
		692999, 4007567, 7716711, 3037922, 8291926, 1857019, 3675238, 1379127, 3686733, 3629313,
		7853498, 5774063, 8386286, 180372, 7619603, 7615172, 7560401, 8015515, 2039821, 2545577,
		7734185, 5859416, 848264, 7795544, 5279069, 4775680, 1772678, 3239835, 1406511, 8319640,
		4417675, 789821, 3688063, 7957560, 6796318, 5264234, 4481427, 7090428, 3361268, 8393123,
		4232317, 4769105, 5113633, 3576752, 7832421, 4828241, 367196, 7078558, 152225, 447433,
		2716628, 4321672, 5324446, 435993, 2661757, 11870, 8222125, 1368093, 3356541, 312129,
		7294528, 6860547, 3784661, 3736529, 2308834, 1266532, 8056564, 2593631, 8080628, 5811362,
		54531, 2192083, 7211174, 7036900, 3364627, 2634625, 5859631, 2905760, 5027996, 4668464,
		896483, 5094234, 1392640, 3677636, 2109110, 1784620, 870345, 2131325, 4916655, 8385734,
		5770663, 5185189, 8353976, 3219804, 5478527, 3915945, 6325147, 3310759, 2353594, 5074975,
		6793207, 457832, 381949, 6273668, 5626630, 3870484, 7220026, 2347886, 95719, 6435240,
		5589833, 6133316, 5171, 4315644, 2272455, 7871167, 1282920, 533826, 5904510, 4163563,
		1900577, 4534509, 1939669, 8186128, 4350612, 1814060, 2464829, 2271677};

int32_t zetas_inv[2303] = {
		2464829, 2271677, 4350612, 1814060, 1939669, 8186128, 1900577, 4534509, 5904510, 4163563,
		1282920, 533826, 2272455, 7871167, 5171, 4315644, 5589833, 6133316, 95719, 6435240,
		7220026, 2347886, 5626630, 3870484, 381949, 6273668, 6793207, 457832, 2353594, 5074975,
		6325147, 3310759, 5478527, 3915945, 8353976, 3219804, 5770663, 5185189, 4916655, 8385734,
		870345, 2131325, 2109110, 1784620, 1392640, 3677636, 896483, 5094234, 5027996, 4668464,
		5859631, 2905760, 3364627, 2634625, 7211174, 7036900, 54531, 2192083, 8080628, 5811362,
		8056564, 2593631, 2308834, 1266532, 3784661, 3736529, 7294528, 6860547, 3356541, 312129,
		8222125, 1368093, 2661757, 11870, 5324446, 435993, 2716628, 4321672, 152225, 447433,
		367196, 7078558, 7832421, 4828241, 5113633, 3576752, 4232317, 4769105, 3361268, 8393123,
		4481427, 7090428, 6796318, 5264234, 3688063, 7957560, 4417675, 789821, 1406511, 8319640,
		1772678, 3239835, 5279069, 4775680, 848264, 7795544, 7734185, 5859416, 2039821, 2545577,
		7560401, 8015515, 7619603, 7615172, 8386286, 180372, 7853498, 5774063, 3686733, 3629313,
		3675238, 1379127, 8291926, 1857019, 7716711, 3037922, 692999, 4007567, 3372081, 6194277,
		4092037, 3809026, 8225795, 4595967, 317605, 7045489, 2041022, 7025866, 4060268, 7573404,
		3219729, 5666045, 3038166, 4397426, 4260335, 8028382, 7201589, 7693381, 6204090, 3270288,
		169391, 3074810, 3969814, 8298717, 5406836, 6651157, 997291, 1753836, 1266753, 6345098,
		4816104, 376611, 965861, 7922106, 1214956, 5939545, 2252566, 5330183, 8202130, 1431440,
		3004946, 5525361, 3207541, 946412, 8364969, 4993111, 1992100, 2150546, 3673436, 2541662,
		64503, 5863331, 4950070, 5939523, 1595299, 6973553, 500835, 3581986, 7375821, 8067023,
		5045022, 3411882, 895337, 2331060, 506665, 1528970, 3424947, 419475, 3769452, 3641049,
		7506945, 1885976, 453984, 6185432, 5704375, 2219561, 440987, 4060524, 1188585, 6073933,
		6267765, 4217036, 6800749, 7714402, 5872427, 4763944, 2810040, 2084296, 6018885, 6134076,
		903145, 4834469, 5030915, 5345923, 1721847, 4869211, 5377306, 4942479, 2972725, 3462514,
		3972, 1775399, 4467637, 6320697, 237691, 6953507, 5029038, 2671562, 1500272, 3059070,
		6077734, 3007582, 7115744, 5481009, 2603546, 2413090, 218750, 7069678, 697451, 7214046,
		507868, 8255511, 674355, 149482, 4484841, 1077775, 6129117, 5397411, 5305236, 1816635,
		3019244, 5331527, 2289253, 1335315, 1567076, 4696166, 7127620, 2760594, 4009955, 75450,
		2766170, 5197781, 6871858, 3791089, 7625955, 6363238, 2910037, 2041755, 7779373, 5273231,
		1774201, 3708827, 8065641, 82262, 1817568, 718839, 7313662, 3207212, 2451650, 3015634,
		7613071, 762092, 6829268, 4368947, 7344113, 8051541, 8188964, 2299407, 5543522, 1869603,
		5059624, 6535390, 3937664, 4015495, 7947821, 5389359, 177974, 5315041, 5771123, 2631695,
		8396540, 353452, 5748567, 3946092, 6226430, 2289957, 976425, 5572756, 693664, 7388898,
		3195343, 6880487, 2555131, 1561442, 8274913, 6843551, 3353002, 4556661, 2918981, 4458901,
		4697693, 2421586, 5512376, 3851399, 5601588, 1016095, 3091737, 4352011, 3915096, 560295,
		3859759, 7413130, 2983411, 4209424, 1726649, 4780898, 2420073, 6175918, 174133, 2229075,
		8232807, 3217561, 375157, 4052982, 991639, 727916, 5650605, 6736213, 7527237, 4195569,
		6435538, 5137886, 7118156, 6409638, 1482220, 736241, 4756030, 3069701, 2735629, 5596643,
		3221793, 5807867, 174400, 2597126, 477281, 3805942, 2589239, 3267107, 3119881, 2329536,
		2678934, 3812512, 5081858, 5335292, 4593587, 3885835, 8205940, 2913982, 6795210, 8139648,
		7418556, 5873073, 2092273, 7931618, 2745579, 4481889, 6918050, 3923104, 8077002, 5607728,
		2160136, 4519158, 7011568, 3412460, 5315714, 7395871, 7919056, 2531920, 4717052, 3883437,
		6611016, 5536459, 584941, 7855704, 706342, 3628681, 3908318, 8086293, 7582299, 458872,
		2537893, 7946121, 1982417, 3079392, 8168042, 4521556, 6422738, 3564737, 914324, 5995331,
		983744, 4776312, 1894809, 5819845, 5756481, 4608494, 1961831, 3485804, 3421193, 6974472,
		6168458, 3763800, 6057592, 3165117, 4298993, 5239876, 8214102, 2055283, 2944985, 2585148,
		2519493, 1178652, 5671898, 7773611, 1147738, 1430521, 5326987, 2595432, 5403300, 4270537,
		1211043, 6690694, 3622502, 6141750, 6938518, 1608477, 4318191, 7505496, 2686639, 899497,
		6636229, 4427451, 1568611, 5809561, 5831477, 4203909, 5804160, 3371040, 7540957, 2263243,
		2354428, 6493102, 3914354, 1065881, 5737960, 5990095, 8013322, 4066565, 8278041, 1048190,
		1801241, 2551138, 5840661, 5853855, 1318, 1651667, 6133565, 1911891, 7218460, 7541292,
		7483684, 3617019, 3274096, 4338428, 6620121, 624194, 1767232, 8280989, 2920976, 4447869,
		8110560, 45645, 3327370, 5100172, 7810093, 5629084, 2368070, 2775909, 4611268, 4493514,
		4467406, 7780799, 5504828, 5724366, 1123779, 5505080, 6552967, 8359348, 3397834, 6102195,
		7333617, 2340044, 412224, 5892222, 8061699, 2775993, 2144811, 5095641, 6072751, 4068434,
		4016976, 4336559, 6800798, 263222, 2497407, 2302798, 505285, 2792843, 1390285, 6408478,
		2723088, 5629000, 1049030, 7437456, 5766847, 3744266, 167415, 623588, 5874020, 5474186,
		5784151, 2433674, 611502, 4048985, 2366396, 4356008, 6016740, 6097774, 2673938, 967537,
		3588481, 1466137, 1811911, 7793251, 8096703, 2930807, 7367899, 519065, 5229322, 1841386,
		3743461, 1743587, 1061958, 7333661, 1610526, 3865230, 6386271, 3201575, 7937146, 5203418,
		3548609, 672255, 5684755, 7885928, 5279006, 4384295, 7589002, 5042961, 978845, 1071332,
		5870687, 509260, 2587542, 1498944, 5837260, 715780, 4225794, 6337410, 5815323, 7704745,
		1452296, 7883819, 5070150, 521174, 8104291, 7053190, 7154775, 7895733, 1824523, 8214005,
		6665935, 977770, 637742, 2067583, 2537991, 6905721, 3637370, 7739477, 4668027, 8301347,
		6826138, 1507849, 4167752, 1811141, 2510101, 6173449, 6551063, 2231544, 2830604, 1404203,
		793704, 1499272, 6527496, 311869, 7172898, 5507933, 6865201, 6897144, 988967, 5838453,
		4439605, 8316926, 1581710, 1195741, 2894488, 107856, 2066004, 8276705, 1081993, 7359364,
		8368587, 1045629, 310111, 1303597, 6193997, 2566540, 6062213, 5710165, 3075932, 7271297,
		2112047, 8297137, 6568929, 2953483, 6247182, 7621356, 3385844, 1187691, 479648, 795378,
		2680586, 5828065, 2961805, 1093831, 6635754, 7311162, 4096279, 1983069, 4215311, 5451510,
		6078801, 376555, 3950454, 310194, 6950031, 7609615, 4337644, 1374539, 2504481, 3790101,
		1736951, 5284644, 6041494, 4746641, 5940881, 4660600, 982111, 6570868, 3626545, 1834125,
		340723, 1626292, 7183623, 7030454, 3348787, 6035139, 1637781, 1955976, 343384, 3658352,
		3195651, 1162358, 4154272, 840575, 2490560, 7716893, 8247820, 6145620, 1668269, 5935419,
		1125823, 6372467, 2268660, 2032526, 7017340, 5457520, 3301396, 7242635, 255063, 7097777,
		2333198, 7213042, 3553115, 2259373, 1173116, 3120509, 2566023, 4780621, 4111973, 888371,
		3261819, 7795168, 6260406, 7967034, 7315705, 4999598, 7492045, 3405395, 3213265, 278546,
		913830, 5284484, 7616321, 2682550, 2363371, 1375226, 4419272, 609825, 5949954, 7467500,
		2653192, 575205, 6400065, 823267, 490026, 2532345, 2804122, 818246, 7111435, 7653679,
		3888624, 751314, 569126, 3355612, 6996581, 937493, 5283241, 8285746, 6463460, 8228884,
		4019854, 5872648, 1755205, 3496090, 5396981, 8315072, 2650310, 2914854, 3221086, 2592676,
		7000082, 6127876, 7407794, 7219580, 7491541, 1185413, 6709211, 5507530, 5706061, 4908903,
		7943119, 1218973, 40015, 7129659, 4974429, 5812317, 5669300, 5096072, 6160780, 6257384,
		413620, 5003254, 4429432, 1935392, 6206544, 6197725, 5300985, 4510640, 1051446, 3894353,
		2483174, 6938646, 3077175, 3308921, 1238975, 2888804, 5714851, 2363031, 2219476, 6469601,
		2836572, 950939, 2089292, 5154271, 2577273, 3488737, 2235894, 3259656, 6360043, 2317176,
		1967591, 4066608, 914530, 4338385, 3090279, 6748393, 6223732, 7454054, 4899274, 3268115,
		2127721, 815886, 3410505, 5145337, 5183998, 5082060, 4742723, 3074642, 7953248, 7094463,
		4583311, 3738240, 7575010, 6057032, 374951, 2496004, 4088045, 5908989, 4962817, 2427710,
		4931505, 3322933, 2818941, 2734099, 8215964, 5570646, 769120, 4666753, 6156769, 285441,
		6522625, 2177869, 7506900, 7784571, 5305231, 7947725, 7823426, 168591, 4955017, 3274433,
		407967, 5130560, 7562931, 7327303, 5746488, 8119552, 7932492, 454032, 2143940, 5452302,
		4142954, 457268, 720722, 476767, 4889378, 4223300, 6198651, 8189481, 4224353, 7288556,
		5237729, 5037301, 8233115, 1323693, 2448537, 7081300, 3157279, 7073044, 4026319, 7928226,
		190494, 5514068, 3644378, 5546993, 6887926, 1116437, 1153340, 4328392, 2058495, 7459760,
		2837528, 326314, 6078806, 3042257, 7551265, 987276, 4284267, 7170841, 290431, 1234152,
		4220099, 3368571, 6128178, 4076601, 5430434, 5315668, 3845450, 6225608, 3398406, 5362736,
		2888055, 7084835, 2094713, 5096328, 3297810, 888158, 5575682, 4574566, 4145792, 6430065,
		5945015, 4575922, 1223069, 3829071, 1777361, 5462724, 5271973, 1320158, 8194029, 5109907,
		5398103, 1267257, 5473969, 3830427, 5332655, 3737833, 775053, 2839405, 3417454, 3373132,
		3282636, 2462383, 5050410, 6619500, 4945626, 1171142, 6413332, 7233851, 4855026, 5835515,
		1400157, 4667160, 6146867, 1952340, 1229586, 4010547, 6769323, 5942610, 6393823, 7945547,
		4996965, 3167354, 2339794, 471908, 2687103, 7079287, 7953767, 6151525, 1292506, 1135517,
		6258634, 7269476, 7066224, 7551195, 2556701, 459446, 1792226, 5692079, 2521994, 4302871,
		4767061, 1325706, 159577, 456826, 1535099, 6869137, 6500772, 1250762, 2825359, 5624167,
		5789815, 1384982, 6550595, 6904771, 406171, 1500222, 3477546, 6874929, 76719, 7948167,
		3627118, 1841808, 7873001, 5368915, 2585818, 2780826, 7171632, 6773664, 6241097, 3991427,
		200210, 4567637, 7418037, 8267993, 3190779, 2544430, 7130109, 4296289, 8067790, 4108704,
		6289421, 4430637, 8009340, 1631329, 1016086, 913101, 4676572, 8287716, 2960884, 137000,
		2600386, 6722545, 5065261, 5880107, 5561365, 1318705, 2423427, 4803834, 7429373, 3686115,
		2339278, 1334881, 1204287, 7070112, 6048652, 6122539, 6920201, 1682448, 4296225, 2003667,
		64479, 7214988, 1114166, 3601159, 6357485, 936471, 2167149, 4706406, 4218374, 6521372,
		4569434, 7825265, 5739839, 74855, 861518, 6158913, 3088345, 2246080, 5296878, 5941644,
		3559563, 7468522, 5316226, 1011326, 98416, 2460326, 1220102, 579728, 2695898, 390337,
		4415594, 43185, 2199724, 5477152, 1061927, 2642775, 7862474, 1730507, 1061026, 1515132,
		2386297, 6889861, 4089620, 8119927, 4544227, 8014656, 256852, 2120844, 8101442, 1558317,
		2868962, 5762218, 4822348, 1556014, 3601184, 8165137, 3718955, 1291499, 7542783, 6945729,
		4617399, 7553490, 3798532, 4002748, 775088, 4402245, 3408152, 8237228, 6272386, 6848979,
		7595908, 704511, 3706138, 3762892, 4882442, 1459264, 6184712, 7852813, 6780739, 3028286,
		1584807, 6203244, 4030085, 6270213, 3556943, 1807289, 1308532, 7378744, 4884289, 1026249,
		2508166, 4068464, 7961863, 552180, 8304009, 1255109, 182827, 2002037, 2560193, 2134780,
		3190534, 170608, 7195223, 5425338, 5734707, 489340, 7596703, 7968938, 4695563, 1837824,
		1275616, 8029437, 2672259, 375556, 5655169, 53285, 2952259, 8234385, 8218140, 2008432,
		1151372, 5049782, 6904101, 436055, 2490863, 7251227, 4875941, 712751, 1845114, 6395159,
		2030009, 5499146, 8247009, 43705, 923239, 5602465, 874428, 2802528, 1020684, 3489312,
		2734127, 1153766, 7754677, 7294932, 4975695, 6315216, 6792039, 2905847, 1968406, 1707967,
		7329055, 8044247, 8108525, 4647167, 7564399, 3062647, 2234481, 6062626, 7456006, 7173753,
		4760469, 1231240, 595299, 7709814, 1721544, 6697026, 4020, 7770593, 3734452, 6813007,
		8403952, 5342346, 122290, 2973376, 1118784, 7032873, 6679782, 4244195, 1487418, 3192952,
		6205316, 854167, 5147067, 7889000, 2645777, 515993, 3567907, 7437147, 8240463, 5431617,
		7445307, 3827543, 7950325, 6516880, 286150, 5212041, 1682318, 7814418, 2434996, 7272087,
		4594806, 7356075, 3887307, 8069514, 198719, 8360147, 1458408, 927381, 316758, 7477612,
		3947129, 7020596, 7833721, 590575, 2134627, 7769572, 6137798, 8199468, 5801151, 335479,
		6080344, 6085359, 4020654, 5330058, 6303576, 7915425, 3929613, 1487097, 4324123, 3146260,
		1535266, 5959433, 2986542, 2445560, 654376, 997529, 2350266, 2319634, 2051694, 826626,
		82329, 2884498, 4775139, 6917896, 688220, 2387596, 4402060, 4550163, 1954392, 7709678,
		2685500, 1583099, 6698800, 7499523, 308157, 4687868, 4724656, 3717125, 6030946, 887784,
		1059673, 6017397, 6448849, 1482126, 8143183, 833038, 3542387, 6821894, 2966254, 5719616,
		7967488, 8077987, 3409280, 2756715, 1731939, 4555215, 4616282, 5500491, 4575684, 5782587,
		1356060, 2622406, 7016262, 7311930, 1906899, 2685377, 7245500, 2815114, 6300791, 5455581,
		1385379, 3849778, 1982341, 6053228, 7227670, 1643945, 233076, 7195237, 1630666, 4263175,
		3435061, 4948878, 6565165, 2368989, 6236896, 6036004, 3958285, 3053419, 3427919, 2351765,
		4080321, 2597113, 3173353, 4012934, 1195165, 4141818, 6392363, 1261986, 4184278, 1768178,
		7483526, 1687276, 965528, 7764035, 6826739, 27987, 4968594, 7601153, 1004253, 803840,
		7341160, 1046318, 1289222, 7143007, 6124052, 1289973, 2490308, 964338, 220591, 640958,
		4307141, 2795100, 7729595, 6677606, 2516353, 7641739, 37923, 5186657, 1207855, 5700774,
		1978525, 8095411, 5480542, 309582, 5417020, 4423403, 5969652, 5609893, 4815956, 90881,
		4579567, 6368024, 5928489, 3218336, 4831078, 5967779, 3682426, 593495, 5661133, 7655428,
		4883958, 5120096, 2836279, 1960853, 2887591, 2295982, 3581890, 6109011, 7405893, 4370531,
		3776738, 2437214, 5987846, 7928632, 1708002, 2889477, 3053345, 3284897, 6713958, 3876720,
		5164872, 4515800, 1661017, 7235603, 197274, 5894153, 3043161, 6546235, 6258932, 4608563,
		8200884, 3796430, 8379093, 4724763, 6883480, 4528273, 6838166, 2017962, 7454905, 719370,
		1076883, 2510840, 8265246, 5131280, 7603213, 1681972, 2965391, 7517826, 926563, 6266243,
		1573250, 365669, 2124750, 8128402, 4698559, 276591, 3841362, 5379076, 2803881, 3273713,
		56522, 5496949, 1307768, 1405381, 7123335, 2138750, 314137, 2912272, 3861250, 5005777,
		3982608, 7918049, 2654400, 5492721, 4429564, 6080505, 1022118, 5989962, 6144348, 3665474,
		7998805, 2324488, 4884425, 3920084, 6413093, 7485516, 4949529, 3000607, 1150270, 4484909,
		6906161, 6717052, 5141860, 7787269, 2042885, 6099328, 2366377, 1687941, 3557943, 3474471,
		7585393, 5948592, 4879722, 1018070, 2943865, 4930522, 1613754, 1059493, 718176, 1126554,
		2762178, 2186047, 8020815, 7345500, 5550621, 6684114, 6841511, 1668062, 2894875, 8352176,
		7568212, 1720879, 2785171, 2769322, 6150636, 1762506, 6680549, 4531828, 7327274, 5635671,
		1951098, 6158940, 894087, 1866609, 4634377, 8025549, 8019193, 2246053, 4151445, 2308598,
		3502978, 2023942, 968824, 4332540, 264222, 6096395, 5952899, 7972448, 6574256, 8261352,
		4317154, 7828807, 3940319, 432545, 157050, 3788961, 1144927, 1316798, 2178601, 5105759,
		421707, 4616032, 2471360, 1888100, 6593856, 5572126, 533274, 7460226, 4046305, 6516893,
		4351720, 2748229, 3588951, 1205804, 7133391, 3954033, 7613492, 5656764, 437663, 6615176,
		7359327, 6135708, 3684852, 4345891, 62725, 1789817, 6466997, 4230204, 6272327, 5126435,
		151844, 951646, 5162778, 4174789, 6547840, 1127008, 7724559, 5509692, 8099460, 6636700,
		2181784, 7277985, 7065598, 3514420, 7484634, 6557861, 4588604, 1667288, 133956, 4890573,
		658962, 6505330, 3502520, 6975046, 4625077, 5075383, 7172708, 1899663, 1543152, 5734035,
		3049450, 6116147, 2896708, 3445189, 3410547, 2670958, 6208098, 6237621, 7700925, 7282022,
		4154213, 5114650, 2254675, 2167372, 2033326, 3522244, 7330106, 592408, 1967458, 4114652,
		6269352, 4882749, 7231488, 2170880, 1752194, 6084101, 5408457, 8254981, 7078619, 6234113,
		1203031, 4122970, 8282850, 3995724, 6650272, 8118694, 834406, 4282023, 3638382, 5191998,
		4373588, 38378, 4423591, 5230376, 2905059, 3212995, 7290660, 3376792, 5565476, 2627822,
		7639276, 6004614, 4471806, 5028201, 1982674, 376345, 767639, 4483655, 708975, 4860000,
		2916807, 8028648, 5186522, 6370499, 8003572, 526760, 8386746, 6897259, 6938462, 2034494,
		5021465, 2727360, 7770178, 4483145, 6856973, 7210505, 5328189, 5677633, 6532576, 1574520,
		4600007, 3191301, 4984262, 4765821, 167912, 6830473, 4496549, 3339816, 227895, 3113125,
		5147187, 6452941, 4581463, 5065177, 7069324, 2265359, 7850887, 259933, 7073645, 2525292,
		3955830, 6139634, 4040621, 7126946, 8129046, 2995310, 561663, 1717263, 4637472, 1278047,
		4551327, 2735042, 6198884, 664902, 5976856, 3399944, 6346292, 5669951, 7097227, 284068,
		6201675, 3646488, 3534051, 3930556, 6712164, 8120925, 5837469, 6280616, 1174089, 2318147,
		7835433, 193770, 7987800, 2124377, 7277837, 4452082, 3887702, 7919340, 6388949, 3966429,
		7898754, 3952911, 1908653, 332874, 5548711, 4452061, 5472635, 4784935, 3150419, 8072119,
		2894702, 8066679, 8171543, 6897522, 642322, 6559208, 8043159, 338314, 3170047, 2042027,
		6911327, 4774106, 7324321, 6816133, 2443041, 6362966, 5140808, 500603, 7394476, 2826879,
		1204573, 3327482, 6986220, 7904390, 305524, 1160638, 1979224, 809890, 4633305, 1970528,
		5879116, 7244355, 1690967, 4915437, 2246699, 7176255, 2482432, 3686699, 1600644, 3489556,
		8253804, 2190915, 7662488, 7367986, 2089037, 1153908, 4994580, 6214078, 8318036, 345586,
		3983219, 1402935, 7383307, 1748521, 5398894, 8059407, 6985765, 6340538, 5085005, 1123889,
		5042866, 7464427, 4164473, 2064455, 4933087, 361211, 6603656, 7576844, 7046327, 7938055,
		4099298, 8043782, 6449055, 1257674, 4810963, 8171341, 1205793, 1024022, 7006888, 7147319,
		523805, 738616, 1019926, 5739205, 5915709, 6477821, 432750, 7666377, 5777692, 6210202,
		4377683, 8388148, 4233387, 6193357, 3017256, 2194791, 6717711, 2610921, 7736376, 1552256,
		5869587, 4163177, 6347835, 5794072, 1176741, 3722818, 7561898, 455315, 5899177, 4178133,
		5471251, 4682175, 5449879, 4288762, 1910632, 3249057, 1957313, 7537819, 2928390, 4116231,
		7314433, 753361, 7290967, 2254012, 1615887, 3007373, 6348454, 7651632, 577673, 5266195,
		5597631, 7201097, 3918781, 4062299, 3998155, 3138798, 2278413, 693033, 1065441, 4378748,
		1502833, 5071781, 3496258, 7711960, 4816015, 6844641, 4840800, 6073363, 4245121, 4513011,
		3877418, 1560352, 4928233, 4729155, 1037511, 5942850, 6894862, 2267012, 2084479, 3675838,
		7149337, 3007404, 2675293, 790345, 3206900, 3797749, 1693494, 5397589, 7669702, 2708046,
		1845714, 7923061, 561790, 2226114, 6623753, 5696947, 7060028, 5326383, 4221177, 1629460,
		4189694, 6955843, 1918808, 3078610, 7301990, 3087154, 1761601, 4128440, 8103639, 7215594,
		433795, 5317839, 2338364, 2776396, 7068951, 745421, 1525979, 3521817, 6533880, 5628597,
		7205603, 2837987, 7100721, 239145, 3283020, 3077132, 5187630, 5567006, 5743809, 1286859,
		5755367, 3410874, 4838745, 5360959, 1062426, 3895117, 1456603, 8334655,
		821844, 7729527, 8126445, 798825, 3052666, 726699, 793830, 7945228, 4929623, 2197388,
		974719, 525758, 3589030, 2983829, 3220515, 1560003, 2563895, 1797363, 8100009, 7830420,
		7598168, 7053336, 3988426, 3451311, 4353329, 4134276, 3460930, 8178965, 4852799, 625110,
		5827398, 2773745, 5634632, 406233, 7259528, 6091045, 5360621, 5195604, 7827705, 2351980,
		1715262, 6083519, 7944276, 314004, 3409000, 6560823, 7091483, 2024945, 7305880, 4559235,
		675651, 1471781, 55755, 3470768, 2256251, 7779088, 677685, 3801741, 2114216, 2862856,
		1939232, 815070, 2586790, 8403817, 3110317, 5451988, 5124518, 2458210, 6224833, 8118885,
		3566556, 8124142, 1512050, 6725315, 7208900, 732926, 5592116, 6373528, 3531130, 155136,
		3938143, 4984286, 4786385, 7456878, 461142, 5495172, 1620349, 3930754, 6714041, 3449617,
		7791777, 4113757, 1036851, 8317937, 220748, 7627574, 6871687, 1694530, 5358811, 6560268,
		2532329, 4663261, 1345414, 1884794, 2307913, 3776163, 8337065, 5874334, 8335086, 8053676,
		5871500, 152155, 7069550, 479162, 1666771, 3553514, 6255744, 453077, 6366112, 565761,
		7102939, 65160, 7818486, 1584985, 1829632, 3763962, 1078201, 5932357, 7214765, 211622,
		7921390, 3461701, 3789562, 4966314, 4122808, 7014236, 2978856, 838375, 1039987, 1207722,
		3583444, 3304066, 135774, 4909535, 5894591, 1586412, 501375, 7499506, 4386748, 5415803,
		1816215, 2196412, 1321111, 872108, 5040367, 7311049, 4376879, 7135647, 2203008, 7318064,
		2083074, 6718583, 5073052, 1288938, 1307395, 3978601, 1065131, 4084609, 6685839, 5367326,
		7653985, 6743870, 3926029, 4496106, 126927, 6676115, 7371901, 3252514, 1455398, 466690,
		4721561, 3291767, 2268029, 2725332, 449515, 7035934, 393808, 7959011, 344899, 8140280,
		673164, 1275810, 7211570, 345133, 454477, 25670, 5450851, 5752573, 5965830, 8298274,
		7440080, 5120278, 4863569, 4160525, 1817508, 5512270, 7464454, 3701888, 4964479, 3166322,
		3499445, 1058265, 4887363, 6383544, 3665768, 1936922, 6122519, 364272, 8119772, 7204505,
		1198081, 6841883, 1765392, 6829837, 7345253, 5586698, 5399245, 2274161, 6163460, 2039124,
		1841291, 5152430, 5710763, 7358254, 3017422, 4164568, 3982109, 2520958, 3238319, 7045447,
		7847463, 2844309, 7399034, 4659597, 3949336};

#elif NIMS_TRI_NTT_MODE == 55
// Q = 8380417
#define MONT 4193792	// 2^32 % Q

#define F1 6290560	// mont^2/2^9
#define F2 4200703	// mont^2/2^8
#define F1_woo 2097152	// mont^2/2^9
#define F2_woo 4194304	// mont^2/2^8

int32_t zetas[2047] = {
		7561323, 5706650, 2647920, 7144876, 2439577, 4535982, 2958486, 8005842, 2230497, 5636984,
		5743245, 3008457, 137451, 4866997, 2276965, 7752683, 1006927, 3170710, 6015733, 4897610,
		2678231, 4405340, 882799, 2005433, 5262615, 5926336, 3360378, 4612763, 7525073, 1786113,
		5358334, 1508753, 5147713, 772140, 1239593, 5298825, 4833419, 828607, 5698961, 642166,
		5370442, 3023997, 600663, 1776800, 7501025, 6697564, 6714808, 8089440, 5149473, 2213667,
		973043, 2422249, 7895776, 6034082, 307760, 1594819, 8114369, 3641288, 4485431, 7127679,
		7757673, 880668, 986500, 6926829, 7789161, 3967585, 3074383, 5049541, 1525090, 680045,
		7392577, 2344290, 2219829, 1413362, 3359157, 8362615, 6270767, 5457821, 8000186, 4832822,
		7470796, 6027456, 5436187, 1995951, 7089643, 6314822, 6831641, 794451, 3341276, 6768418,
		7649016, 3599124, 6509600, 7071962, 732115, 4977297, 4788193, 5716932, 1596706, 180811,
		1713829, 1804991, 4568529, 2600011, 4063361, 3396392, 4711836, 3525356, 4595484, 3387848,
		5117238, 270397, 8279945, 4141039, 4931313, 5290083, 1893695, 2438269, 5040543, 2412876,
		5215512, 5787052, 3589753, 4346555, 4242930, 7819488, 2609950, 4637099, 2698043, 2671590,
		5310391, 7815823, 624009, 4083750, 5631006, 6932733, 4684164, 3835287, 1971810, 3970701,
		4927475, 4460286, 2501200, 2139434, 5678215, 3868967, 5175998, 7209768, 419856, 3256960,
		4218478, 2486766, 7159150, 7452817, 6066166, 1064630, 3874971, 3800072, 4578452, 4792693,
		4766814, 8343283, 2691811, 687142, 317366, 5354706, 2693942, 7365035, 7630086, 2454784,
		2167708, 2966118, 5553870, 7612758, 7675617, 4243388, 5930681, 7397419, 7223450, 4300953,
		2275330, 5678818, 6524283, 6988129, 4762851, 5921147, 4577635, 2894, 4959201, 8037356,
		3124558, 7863844, 3589119, 4191505, 1206727, 1084777, 2430556, 2891552, 2347580, 2028435,
		3547376, 442837, 8242897, 4247785, 8093754, 3826922, 4893437, 153355, 7159709, 5963171,
		5267266, 4874498, 5328539, 6762842, 804360, 7650430, 7724287, 4800553, 8042644, 2744850,
		2705295, 6268629, 5545332, 5710170, 6966991, 4002882, 75432, 3381281, 3115980, 8208929,
		6724459, 1720200, 5619767, 1175232, 4123752, 6439632, 1039037, 2186416, 1247942, 2194960,
		842540, 506914, 2866130, 4944254, 5997049, 4007400, 7076221, 3983789, 3835656, 192555,
		1533239, 6190344, 202650, 3752636, 4639964, 4417095, 6474994, 4183454, 2830498, 6342258,
		5365054, 3124956, 5797342, 5837589, 2080490, 7799182, 5939264, 2820475, 947258, 5814606,
		4624630, 2668922, 3153556, 6720925, 5223825, 7955237, 3860689, 7063357, 1122756, 380460,
		2216022, 6566141, 5411819, 2699890, 6251020, 5459209, 5038846, 4112203, 14232, 647891,
		8129637, 1575469, 7278735, 2286383, 7715796, 1189629, 2799154, 5867774, 7186623, 1633718,
		8322569, 654655, 1523381, 6065655, 2452553, 2876001, 4492000, 2979846, 2830930, 5533668,
		3136040, 569605, 7595149, 5680477, 7887421, 6280746, 5317618, 8250670, 2125021, 5949643,
		1718944, 7303869, 3270092, 5737300, 1854376, 5512763, 3710112, 8127220, 5499045, 5443738,
		8026928, 1400886, 3362615, 3918841, 6940897, 6454333, 4596438, 6197663, 6782164, 8084377,
		3924310, 6361189, 1153477, 966983, 5112481, 256437, 3528015, 6048182, 2345890, 5569883,
		2694756, 3030346, 3236088, 3028029, 6247393, 5321653, 1702236, 2894789, 657971, 7017725,
		933887, 6200467, 316724, 6949676, 5486879, 2078761, 2536590, 3823608, 8075636, 4119751,
		3351947, 3085520, 6420884, 8099703, 2549747, 1917444, 4853070, 1967560, 7912984, 1261629,
		7857424, 4867585, 7639839, 1494163, 4227466, 3648403, 3047315, 1196936, 33660, 3475505,
		1187544, 4798678, 6077702, 2818109, 4908393, 4601311, 3242654, 282617, 7252852, 3606120,
		7378214, 8107530, 5268056, 6580172, 3998655, 138659, 4702589, 6668555, 3954006, 2799748,
		465332, 3982831, 856158, 242411, 6041460, 2460448, 4912142, 1439287, 1252165, 7259108,
		5352749, 3593498, 5422968, 928866, 7703806, 3219869, 1287955, 2850072, 690517, 1475022,
		4129326, 2784724, 7957865, 134525, 3427461, 3737220, 2970303, 5203882, 2741120, 4066134,
		5901891, 1768220, 5012654, 5644487, 7558848, 7998497, 3338189, 7325949, 1469128, 5993514,
		4916277, 5838619, 2467117, 2024501, 4381403, 2536601, 3694024, 905299, 2413130, 281902,
		760175, 3874716, 1483958, 3487674, 2346252, 47703, 6734908, 6216740, 4529291, 1469168,
		1476299, 1355833, 1527864, 5266226, 8210474, 6442785, 977708, 3946850, 7536341, 2804691,
		425002, 967442, 2201106, 5210009, 102237, 3613704, 5229285, 3307235, 5393493, 6376326,
		3442544, 3565972, 3845331, 5997946, 6400900, 4634103, 2110444, 4839507, 3593101, 4297986,
		4717194, 7985191, 5064175, 6432983, 7810505, 7431224, 4412995, 7647839, 4074862, 5145341,
		6160295, 3541077, 6338950, 5911369, 4959197, 3033271, 1608364, 1966033, 399513, 747679,
		3700849, 3376463, 5522084, 6649688, 2136179, 8085550, 3933389, 3357178, 2229269, 3812196,
		4215048, 6647117, 2887878, 8236845, 1939427, 7873657, 2529107, 181689, 3849665, 6002791,
		8260230, 968841, 5012551, 1536541, 4041072, 5134560, 2040247, 947871, 8043804, 5817424,
		6268227, 3643798, 3718971, 4782040, 5348792, 7962119, 8136314, 6687710, 3780766, 2164657,
		1615360, 5810509, 1435081, 1181313, 4770951, 841910, 1636723, 8131869, 2777278, 2787396,
		7642758, 971529, 3190093, 4043855, 785506, 2590114, 6751653, 1514545, 4213756, 3051367,
		6399451, 4558407, 1653158, 1735528, 3009233, 377536, 7415969, 2026249, 5216542, 7344913,
		6195489, 6379686, 5354680, 6408337, 3083032, 4225703, 2750272, 409743, 3257137, 8090254,
		4934296, 5233044, 7324936, 6247959, 7550109, 5740511, 7851973, 6334463, 8012460, 5210204,
		1111111, 3643322, 4565474, 7711090, 6329098, 1738406, 1095368, 6893603, 573317, 7995742,
		473382, 2785945, 3444891, 3410410, 7142275, 3368831, 3812649, 5027898, 5629943, 6005341,
		7915601, 5765651, 609204, 7361501, 4302006, 204188, 7095912, 7359228, 5263200, 7514705,
		22313, 71851, 763314, 1166918, 4859578, 8116929, 261114, 3901915, 8203054, 2021526,
		3386734, 75255, 625339, 7315806, 5334347, 2293490, 2841147, 6821396, 1921999, 2633242,
		3999069, 8315340, 3211409, 2416367, 5785509, 5115496, 449517, 1130927, 958782, 4758764,
		403301, 631269, 5893376, 2436383, 5683233, 4324436, 813869, 7693417, 4113280, 532892,
		5717783, 1765034, 4516462, 3030483, 6566453, 7149873, 2549698, 1282311, 6817238, 5068440,
		328215, 232335, 6213527, 4477261, 289213, 1594804, 4813526, 5881512, 6664245, 4030347,
		1638308, 3140760, 2340305, 4763946, 7702151, 269206, 2633771, 4793178, 2548650, 5746182,
		2080300, 2911129, 1177386, 2846378, 4055530, 8335446, 6153357, 8096439, 8354339, 256983,
		1324612, 5696414, 1852274, 6015180, 7548800, 7234878, 3336235, 3945972, 5400505, 253592,
		5999401, 6275955, 3608739, 4738437, 4139685, 7501727, 179063, 7465579, 5307612, 4764795,
		6808524, 854866, 6695237, 6514731, 5885527, 954967, 5776787, 7858340, 2532009, 453943,
		77040, 4180115, 511292, 647753, 1227049, 5881297, 1254247, 608263, 1700140, 8064595,
		1885068, 5833566, 3442516, 1023217, 6905173, 3453399, 2295297, 7702088, 4837681, 310128,
		5529646, 7976773, 3027157, 1516186, 8320216, 3712331, 1756009, 2545132, 7132225, 3058653,
		4041027, 6978535, 380502, 2269448, 1969197, 5605697, 2843356, 6140710, 968737, 3746320,
		2562060, 464764, 4618919, 2178813, 2567970, 7757743, 8276255, 4499483, 2918895, 7337214,
		8179206, 8049107, 2808278, 2179025, 5641716, 5920060, 1704305, 4600283, 1620056, 5199907,
		7961510, 1734131, 7342234, 65334, 1384449, 6540081, 2952475, 2924891, 2584190, 4588795,
		2824281, 2368615, 431, 1575141, 467554, 431418, 4517999, 1638984, 5612722, 5856742,
		3143221, 1243677, 6261012, 7586395, 3906497, 5929270, 360993, 4532568, 895899, 2949030,
		6364674, 296587, 5824927, 3805810, 3494044, 7862790, 1273310, 895413, 2493790, 1286735,
		4865328, 2319937, 4981987, 3625500, 6435117, 4067766, 2999595, 6092192, 7637617, 713195,
		2912400, 3456497, 6891711, 5007764, 3230755, 5531028, 436445, 7638414, 8176, 2049226,
		6380315, 1164601, 7870883, 8324988, 7744209, 6025404, 8099466, 7210177, 3266505, 2937418,
		394931, 341035, 231932, 1181043, 4018696, 7644274, 7333707, 2929385, 7655797, 3890808,
		4416271, 3455162, 6431279, 1162328, 451660, 1766624, 2428306, 2905715, 3164500, 250385,
		5910279, 1648377, 4313693, 5172625, 6442917, 6608972, 6021963, 4982450, 677163, 4888900,
		5104222, 7975037, 3156609, 8254878, 7951724, 5555669, 4063637, 3260568, 3717716, 2142505,
		6009195, 7260764, 4379635, 1073014, 1782245, 4815893, 6396701, 6033101, 7351720, 5235003,
		7661598, 7066135, 2344522, 2963804, 2521010, 6831715, 6617170, 8182667, 3391931, 5419099,
		3163765, 4611841, 7439348, 7607419, 1025695, 2315095, 5458909, 8049260, 4631292, 5441922,
		7312718, 771344, 7091865, 2792234, 1257361, 7424029, 5007449, 4090963, 2293230, 4171215,
		3028690, 2947968, 612332, 3442300, 1945047, 729463, 6024686, 2093312, 6607229, 6759115,
		3611852, 2010963, 7012936, 6898232, 1830843, 1648171, 5912451, 2036965, 3413354, 5145865,
		791739, 5709679, 4512651, 1072721, 2673031, 527211, 908477, 7098548, 4967349, 6578157,
		4747513, 1042685, 1861854, 4504737, 7624874, 1481281, 3720527, 3409031, 351537, 1344079,
		7888309, 7522516, 4247973, 6342193, 7822235, 1658704, 4064980, 2159728, 1384310, 2795336,
		3381833, 2456725, 5247692, 1003195, 2334945, 2537657, 4773862, 745369, 6576464, 5471483,
		4162204, 7344329, 6741090, 2988639, 3584853, 3011578, 3090824, 6685864, 4845287, 3368592,
		4853886, 4452365, 7591026, 2365437, 2940772, 6619861, 2062496, 2079678, 1522034, 7439887,
		1700863, 2355911, 6817911, 7252911, 968115, 7817531, 1037317, 1144917, 3931981, 7687291,
		1943969, 2649943, 3506769, 1357704, 5964748, 1016737, 5611887, 7482212, 4936241, 272445,
		8088608, 6116440, 6910809, 1592026, 3591760, 6778397, 4568415, 1948900, 8068622, 1012865,
		1652481, 2886504, 4423260, 4337854, 5297260, 2081448, 5522326, 5889408, 4453431, 2089782,
		807207, 3198753, 2360504, 2201778, 2767152, 2426528, 7557385, 4364138, 3414524, 8251603,
		7983531, 6082978, 3072454, 5823525, 2936133, 3398461, 4113429, 1226365, 3033479, 6564075,
		8346478, 7957140, 5282871, 3805968, 6417339, 7172237, 1229609, 6104483, 445430, 995289,
		2345197, 7747016, 4306658, 6457387, 2862546, 6307877, 3777226, 5141647, 1144891, 3092473,
		4531415, 6618135, 4392510, 5108987, 4507185, 1295449, 8347812, 4564086, 7698435, 6348845,
		3387019, 1114918, 1206383, 8373709, 5520736, 1109420, 4821777, 2063974, 1843440, 4105801,
		800579, 4760123, 2792915, 6226911, 121312, 3214286, 2959406, 1788871, 2178976, 6821681,
		5975097, 2611562, 1637926, 170910, 6874063, 5286890, 1533193, 1064821, 7355787, 6566324,
		5456102, 3378707, 1531427, 8048908, 4271346, 5495232, 5924940, 1309050, 4495069, 2399713,
		6563950, 2193722, 3290642, 3265672, 556516, 6765512, 1725224, 448266, 1176209, 5377283,
		8019822, 5230906, 4472049, 633810, 6920408, 6765536, 3654406, 6074456, 6643009, 5304764,
		1049972, 4442059, 7432669, 4021501, 4306157, 2143956, 1826645, 1184243, 4243508, 7869483,
		832148, 4527885, 7868339, 3949324, 3876108, 4698000, 7406063, 7920100, 166547, 6337583,
		7393610, 7088998, 6915306, 2596269, 3570010, 7120023, 4119056, 6230369, 133788, 1633598,
		7057076, 1815613, 2193059, 5781356, 3860021, 8363733, 2557172, 8269830, 3052062, 4320498,
		4119838, 2261212, 4784656, 8186278, 5227421, 1695354, 7163556, 1033618, 2827618, 366476,
		3915327, 1065441, 1323542, 3052209, 5641514, 3954727, 4496626, 5083468, 7124574, 541520,
		3684101, 5160574, 7785673, 6291362, 6650061, 3655403, 1443987, 3548252, 1343372, 7465381,
		1962486, 1256602, 1145617, 2788436, 1849530, 1096059, 2825089, 901365, 3247157, 5718304,
		142717, 7415386, 3740288, 971647, 5691557, 4814440, 3434805, 335740, 8292733, 678807,
		1460262, 4283848, 1021262, 5244620, 2020489, 3562052, 4407978, 6851315, 3803935, 2928701,
		2956612, 4858168, 7009686, 1331745, 3941996, 4263113, 5483220, 3029226, 8185654, 4409871,
		4039985, 325456, 2919112, 3861591, 4490198, 8319014, 3825689, 403215, 6485904, 2215218,
		2035279, 6326229, 1211531, 6933394, 2645973, 1287027, 402319, 3020959, 827204, 2490801,
		6761715, 8222585, 6594390, 4585655, 7422424, 7605765, 762838, 527608, 2790535, 4279466,
		2159032, 6426124, 1891839, 2137083, 4559776, 2771706, 7692784, 7915239, 8194985, 7455962,
		2568304, 3968731, 7198445, 2242616, 7291307, 2050812, 6764101, 3412782, 7853644, 533562,
		2307931, 1829590, 629444, 2988019, 1236681, 645232, 4601141, 4369063, 6117516, 5857804,
		515146, 2880619, 8357158, 3543901, 4274634, 2055325, 4284192, 2122630, 6969894, 509529,
		64320, 3512444, 5867276, 7628924, 6779088, 1965418, 7532039, 1272961, 2493933, 5054593,
		5357885, 5438382, 7692551, 2103246, 2004516, 5349854, 970302, 3420704, 6336041, 6857113,
		7542482, 1497545, 924338, 3612363, 96349, 5643530, 8151573, 3429449, 3231600, 1871907,
		428289, 1293142, 5179262, 7913351, 1693229, 4169439, 2736311, 5779657, 2075052, 3430900,
		7429467, 6070706, 2713125, 3872825, 1026367, 3884460, 5353069, 5379306, 2327080, 7772978,
		285245, 5858592, 7987175, 4164387, 7283933, 5315309, 167092, 3122913, 7088960, 5436384,
		2125864, 5866249, 6817598, 7077474, 5225758, 4215081, 5125742, 3446913, 4709924, 5810961,
		7039813, 594585, 7045473, 3666344, 7251359, 2034098, 2719587, 2292163, 5817248, 1641760,
		8070459, 3500282, 4572878, 423804, 65242, 264599, 4541398, 733699, 2928212, 8143735,
		2626210, 2799712, 5951976, 125457, 821002, 6855171, 890275, 3272518, 1938368, 1587199,
		7369525, 4621028, 7739077, 7724405, 3231451, 2951200, 6202859, 253639, 6285542, 5499550,
		2436157, 5236334, 2213555, 7074455, 6281200, 6274886, 6372504, 6515585, 6092181, 3587358,
		3525037, 3182768, 4537287, 2513877, 1217634, 7648505, 3136952, 4568316, 8309874, 7513926,
		7939457, 2999174, 501411, 6665493, 2251365, 8120317, 1630490, 6949734, 3165388, 2355673,
		3050954, 3149134, 6427434, 6941084, 2033917, 2556585, 6606450, 7021018, 6539175, 6547105,
		3278329, 337402, 3611706, 125735, 5009790, 5003660, 176896, 5745385, 4360349, 4812075,
		2587746, 682417, 8103946, 7070238, 1826158, 4854167, 3156448, 2747164, 5738155, 1400045,
		7692775, 8284034, 7863036, 7907366, 382341, 1314196, 519729, 5759390, 2253974, 5500378,
		1949600, 5070443, 6995183, 7132894, 7233627, 5757811, 1734498, 7787004, 6152217, 7228211,
		4470608, 3749293, 4792700, 5756504, 731306, 2413875, 3808647, 1986749, 3489071, 3994406,
		359905, 6596094, 3043082, 4488763, 7194025, 3261380, 4738510, 7940405, 1645427, 4893258,
		2037270, 1255165, 5056787, 5364819, 607454, 1785572, 281601, 4588132, 6098443, 5849762,
		767256, 5747218, 7139431, 2582213, 7862186, 381539, 1652819, 736423, 3999527, 795398,
		547989, 7244004, 3621203, 8070510, 4552856, 5175826, 1859535, 6724544, 2115431, 6271895,
		6885186, 3460961, 5361632, 8331181, 6220368, 2686008, 3578723, 6514070, 7923718, 4515150,
		4511910, 427665, 6632280, 1943790, 6557318, 4358033, 838143, 7553171, 3835099, 2531404,
		1474748, 4803047, 403118, 2870669, 6086805, 5018009, 3374351, 693930, 4020709, 3251584,
		7863394, 472189, 4354889, 5161637, 349404, 7320772, 3650976, 4330612, 5605573, 8281781,
		4844937, 535661, 8311210, 536200, 6243497, 6869066, 8099386, 6763725, 4040477, 4646461,
		7985939, 3444062, 2508806, 2868073, 1337099, 7081592, 8008237, 4347860, 6482093, 5669591,
		5802723, 2500699, 7645646, 5485528, 2477660, 1913966, 439470, 1256283, 1343192, 7973388,
		3994033, 7028521, 8354778, 5300568, 4568277, 3659672, 7285451, 519191, 4325740, 4839971,
		1782007, 1480130, 6876601, 6583157, 7193886, 4436115, 1735418, 4540785, 5631956, 3343661,
		4453732, 3430914, 7158087, 350097, 6546304, 4069798, 4315609, 3308455, 5688713, 2953670,
		5014568, 357275, 3886978, 2506538, 6997830, 475169, 6449839, 4174188, 5259330, 5973160,
		4387227, 3123238, 3183472, 2768633, 217358, 5380833, 1460134, 4959802, 1516377, 1081281,
		760278, 7999399, 7403207, 6374689, 5244559, 7250973, 224383, 587710, 2634158, 6116716,
		3955151, 7094488, 8243796, 2191815, 4340402, 3697333, 1561336, 829087, 2380516, 189587,
		402880, 2961283, 5895102, 6202293, 3231496, 1351059, 1883857, 7036795, 7197121, 2204924,
		2841513, 2997622, 4247369, 4168242, 798050, 7826514, 1699833, 1595493, 2232575, 8015116,
		3238198, 7186208, 3373907, 4920455, 1611920, 3665734, 7103749, 3745426, 1933575, 342672,
		6810334, 6765634, 1754746, 3834894, 5998227, 1362947, 4897942, 410024, 1401760, 3802883,
		6357739, 4141970, 3645377, 7234242, 2495414, 6958001, 2143421, 7436574, 74868, 3710181,
		6318948, 2394587, 6559997, 3269834, 1288884, 4088792, 7263239, 7125807, 8128983, 7259029,
		8081310, 917353, 3406626, 6915756, 8132122, 2113994, 5567043, 6959970, 4680645, 275738,
		5313479, 6522423, 4037500, 1532066, 8178783, 241221, 3967509, 7136778, 3777207, 1264427,
		5099897, 6785453, 1879567, 4046849, 2609076, 4833530, 5718746, 4206054, 6513337, 7156504,
		6901969, 657747, 1447291, 5584878, 553177, 6026915, 359454, 6322542, 4440854, 7825098,
		5203933, 904685, 4737462, 7120134, 6756210, 6435327, 684217, 8219012, 6416702, 565150,
		7753567, 593645, 1322653, 4028839, 3334155, 4321465, 5727675, 6247914, 6027997, 4080766,
		6007998, 917329, 1477444, 443614, 1561724, 7331548, 6670743, 6716880, 3420698, 6828376,
		4297964, 2355426, 655658, 8175440, 7001087, 8235467, 7101329, 3027510, 4335813, 3648002,
		3637199, 1320356, 6818784, 7829833, 7998332, 7529279, 2449911, 4054716, 5749216, 5317153,
		338542, 4528629, 629645, 2724848, 2536191, 7869429, 681697, 4481073, 7806081, 6207596,
		6987645, 4405743, 7437361, 1712493, 4166951, 7122077, 219806, 5633597, 7946092, 6791441,
		5526707, 1425797, 7742062, 7691082, 1487490, 358030, 2421069, 6434912, 1545481, 5948679,
		2447359, 7056885, 3266003, 4459938, 8049729, 5510177, 1160968, 4245895, 2827969, 7437762,
		3384790, 4058604, 8201271, 1820349, 179264, 4816102, 7134195, 6569474, 3058521, 2235019,
		4903422, 3356034, 5249653, 8175662, 3894978, 1723439, 2694187, 7969938, 7418090, 7347167,
		4405394, 2684840, 4669925, 2483803, 7129072, 8044408, 2907652, 611777, 627096, 3293320,
		2163675, 368823, 7505708, 4757351, 6243653, 6389204, 6421425, 7347647, 1086949, 6892440,
		2764800, 1033423, 1818744, 920255, 3421943, 3143131, 7859868, 4775586, 4748717, 4982118,
		4718341, 2695472, 4495017, 5461686, 3714865, 1059742, 7637975, 4159426, 1687168, 186226,
		3298938, 5984576, 5775873, 877906, 6637800, 1795430, 743701, 6325112, 116932, 3912290,
		3432288, 3614630, 2843068, 5390220, 3869018, 6416339, 2409091, 2523842, 6788830, 3467055,
		2165228, 2170491, 8247680, 6366425, 222361, 5226428, 6273508, 1345835, 3779564, 590331,
		4504852, 7803914, 6397411, 1554298, 4628610, 4086902, 1997454, 7003347, 3087386, 4540854,
		702833, 1486888, 3978258, 4269974, 1785498, 7465976, 7189670};
int32_t zetas_inv[2047] = {
		1190747, 914441, 6594919, 4110443, 4402159, 6893529, 7677584, 3839563, 5293031, 1377070,
		6382963, 4293515, 3751807, 6826119, 1983006, 576503, 3875565, 7790086, 4600853, 7034582,
		2106909, 3153989, 8158056, 2013992, 132737, 6209926, 6215189, 4913362, 1591587, 5856575,
		5971326, 1964078, 4511399, 2990197, 5537349, 4765787, 4948129, 4468127, 8263485, 2055305,
		7636716, 6584987, 1742617, 7502511, 2604544, 2395841, 5081479, 8194191, 6693249, 4220991,
		742442, 7320675, 4665552, 2918731, 3885400, 5684945, 3662076, 3398299, 3631700, 3604831,
		520549, 5237286, 4958474, 7460162, 6561673, 7346994, 5615617, 1487977, 7293468, 1032770,
		1958992, 1991213, 2136764, 3623066, 874709, 8011594, 6216742, 5087097, 7753321, 7768640,
		5472765, 336009, 1251345, 5896614, 3710492, 5695577, 3975023, 1033250, 962327, 410479,
		5686230, 6656978, 4485439, 204755, 3130764, 5024383, 3476995, 6145398, 5321896, 1810943,
		1246222, 3564315, 8201153, 6560068, 179146, 4321813, 4995627, 942655, 5552448, 4134522,
		7219449, 2870240, 330688, 3920479, 5114414, 1323532, 5933058, 2431738, 6834936, 1945505,
		5959348, 8022387, 6892927, 689335, 638355, 6954620, 2853710, 1588976, 434325, 2746820,
		8160611, 1258340, 4213466, 6667924, 943056, 3974674, 1392772, 2172821, 574336, 3899344,
		7698720, 510988, 5844226, 5655569, 7750772, 3851788, 8041875, 3063264, 2631201, 4325701,
		5930506, 851138, 382085, 550584, 1561633, 7060061, 4743218, 4732415, 4044604, 5352907,
		1279088, 144950, 1379330, 204977, 7724759, 6024991, 4082453, 1552041, 4959719, 1663537,
		1709674, 1048869, 6818693, 7936803, 6902973, 7463088, 2372419, 4299651, 2352420, 2132503,
		2652742, 4058952, 5046262, 4351578, 7057764, 7786772, 626850, 7815267, 1963715, 161405,
		7696200, 1945090, 1624207, 1260283, 3642955, 7475732, 3176484, 555319, 3939563, 2057875,
		8020963, 2353502, 7827240, 2795539, 6933126, 7722670, 1478448, 1223913, 1867080, 4174363,
		2661671, 3546887, 5771341, 4333568, 6500850, 1594964, 3280520, 7115990, 4603210, 1243639,
		4412908, 8139196, 201634, 6848351, 4342917, 1857994, 3066938, 8104679, 3699772, 1420447,
		2813374, 6266423, 248295, 1464661, 4973791, 7463064, 299107, 1121388, 251434, 1254610,
		1117178, 4291625, 7091533, 5110583, 1820420, 5985830, 2061469, 4670236, 8305549, 943843,
		6236996, 1422416, 5885003, 1146175, 4735040, 4238447, 2022678, 4577534, 6978657, 7970393,
		3482475, 7017470, 2382190, 4545523, 6625671, 1614783, 1570083, 8037745, 6446842, 4634991,
		1276668, 4714683, 6768497, 3459962, 5006510, 1194209, 5142219, 365301, 6147842, 6784924,
		6680584, 553903, 7582367, 4212175, 4133048, 5382795, 5538904, 6175493, 1183296, 1343622,
		6496560, 7029358, 5148921, 2178124, 2485315, 5419134, 7977537, 8190830, 5999901, 7551330,
		6819081, 4683084, 4040015, 6188602, 136621, 1285929, 4425266, 2263701, 5746259, 7792707,
		8156034, 1129444, 3135858, 2005728, 977210, 381018, 7620139, 7299136, 6864040, 3420615,
		6920283, 2999584, 8163059, 5611784, 5196945, 5257179, 3993190, 2407257, 3121087, 4206229,
		1930578, 7905248, 1382587, 5873879, 4493439, 8023142, 3365849, 5426747, 2691704, 5071962,
		4064808, 4310619, 1834113, 8030320, 1222330, 4949503, 3926685, 5036756, 2748461, 3839632,
		6644999, 3944302, 1186531, 1797260, 1503816, 6900287, 6598410, 3540446, 4054677, 7861226,
		1094966, 4720745, 3812140, 3079849, 25639, 1351896, 4386384, 407029, 7037225, 7124134,
		7940947, 6466451, 5902757, 2894889, 734771, 5879718, 2577694, 2710826, 1898324, 4032557,
		372180, 1298825, 7043318, 5512344, 5871611, 4936355, 394478, 3733956, 4339940, 1616692,
		281031, 1511351, 2136920, 7844217, 69207, 7844756, 3535480, 98636, 2774844, 4049805,
		4729441, 1059645, 8031013, 3218780, 4025528, 7908228, 517023, 5128833, 4359708, 7686487,
		5006066, 3362408, 2293612, 5509748, 7977299, 3577370, 6905669, 5849013, 4545318, 827246,
		7542274, 4022384, 1823099, 6436627, 1748137, 7952752, 3868507, 3865267, 456699, 1866347,
		4801694, 5694409, 2160049, 49236, 3018785, 4919456, 1495231, 2108522, 6264986, 1655873,
		6520882, 3204591, 3827561, 309907, 4759214, 1136413, 7832428, 7585019, 4380890, 7643994,
		6727598, 7998878, 518231, 5798204, 1240986, 2633199, 7613161, 2530655, 2281974, 3792285,
		8098816, 6594845, 7772963, 3015598, 3323630, 7125252, 6343147, 3487159, 6734990, 440012,
		3641907, 5119037, 1186392, 3891654, 5337335, 1784323, 8020512, 4386011, 4891346, 6393668,
		4571770, 5966542, 7649111, 2623913, 3587717, 4631124, 3909809, 1152206, 2228200, 593413,
		6645919, 2622606, 1146790, 1247523, 1385234, 3309974, 6430817, 2880039, 6126443, 2621027,
		7860688, 7066221, 7998076, 473051, 517381, 96383, 687642, 6980372, 2642262, 5633253,
		5223969, 3526250, 6554259, 1310179, 276471, 7698000, 5792671, 3568342, 4020068, 2635032,
		8203521, 3376757, 3370627, 8254682, 4768711, 8043015, 5102088, 1833312, 1841242, 1359399,
		1773967, 5823832, 6346500, 1439333, 1952983, 5231283, 5329463, 6024744, 5215029, 1430683,
		6749927, 260100, 6129052, 1714924, 7879006, 5381243, 440960, 866491, 70543, 3812101,
		5243465, 731912, 7162783, 5866540, 3843130, 5197649, 4855380, 4793059, 2288236, 1864832,
		2007913, 2105531, 2099217, 1305962, 6166862, 3144083, 5944260, 2880867, 2094875, 8126778,
		2177558, 5429217, 5148966, 656012, 641340, 3759389, 1010892, 6793218, 6442049, 5107899,
		7490142, 1525246, 7559415, 8254960, 2428441, 5580705, 5754207, 236682, 5452205, 7646718,
		3839019, 8115818, 8315175, 7956613, 3807539, 4880135, 309958, 6738657, 2563169, 6088254,
		5660830, 6346319, 1129058, 4714073, 1334944, 7785832, 1340604, 2569456, 3670493, 4933504,
		3254675, 4165336, 3154659, 1302943, 1562819, 2514168, 6254553, 2944033, 1291457, 5257504,
		8213325, 3065108, 1096484, 4216030, 393242, 2521825, 8095172, 607439, 6053337, 3001111,
		3027348, 4495957, 7354050, 4507592, 5667292, 2309711, 950950, 4949517, 6305365, 2600760,
		5644106, 4210978, 6687188, 467066, 3201155, 7087275, 7952128, 6508510, 5148817, 4950968,
		228844, 2736887, 8284068, 4768054, 7456079, 6882872, 837935, 1523304, 2044376, 4959713,
		7410115, 3030563, 6375901, 6277171, 687866, 2942035, 3022532, 3325824, 5886484, 7107456,
		848378, 6414999, 1601329, 751493, 2513141, 4867973, 8316097, 7870888, 1410523, 6257787,
		4096225, 6325092, 4105783, 4836516, 23259, 5499798, 7865271, 2522613, 2262901, 4011354,
		3779276, 7735185, 7143736, 5392398, 7750973, 6550827, 6072486, 7846855, 526773, 4967635,
		1616316, 6329605, 1089110, 6137801, 1181972, 4411686, 5812113, 924455, 185432, 465178,
		687633, 5608711, 3820641, 6243334, 6488578, 1954293, 6221385, 4100951, 5589882, 7852809,
		7617579, 774652, 957993, 3794762, 1786027, 157832, 1618702, 5889616, 7553213, 5359458,
		7978098, 7093390, 5734444, 1447023, 7168886, 2054188, 6345138, 6165199, 1894513, 7977202,
		4554728, 61403, 3890219, 4518826, 5461305, 8054961, 4340432, 3970546, 194763, 5351191,
		2897197, 4117304, 4438421, 7048672, 1370731, 3522249, 5423805, 5451716, 4576482, 1529102,
		3972439, 4818365, 6359928, 3135797, 7359155, 4096569, 6920155, 7701610, 87684, 8044677,
		4945612, 3565977, 2688860, 7408770, 4640129, 965031, 8237700, 2662113, 5133260, 7479052,
		5555328, 7284358, 6530887, 5591981, 7234800, 7123815, 6417931, 915036, 7037045, 4832165,
		6936430, 4725014, 1730356, 2089055, 594744, 3219843, 4696316, 7838897, 1255843, 3296949,
		3883791, 4425690, 2738903, 5328208, 7056875, 7314976, 4465090, 8013941, 5552799, 7346799,
		1216861, 6685063, 3152996, 194139, 3595761, 6119205, 4260579, 4059919, 5328355, 110587,
		5823245, 16684, 4520396, 2599061, 6187358, 6564804, 1323341, 6746819, 8246629, 2150048,
		4261361, 1260394, 4810407, 5784148, 1465111, 1291419, 986807, 2042834, 8213870, 460317,
		974354, 3682417, 4504309, 4431093, 512078, 3852532, 7548269, 510934, 4136909, 7196174,
		6553772, 6236461, 4074260, 4358916, 947748, 3938358, 7330445, 3075653, 1737408, 2305961,
		4726011, 1614881, 1460009, 7746607, 3908368, 3149511, 360595, 3003134, 7204208, 7932151,
		6655193, 1614905, 7823901, 5114745, 5089775, 6186695, 1816467, 5980704, 3885348, 7071367,
		2455477, 2885185, 4109071, 331509, 6848990, 5001710, 2924315, 1814093, 1024630, 7315596,
		6847224, 3093527, 1506354, 8209507, 6742491, 5768855, 2405320, 1558736, 6201441, 6591546,
		5421011, 5166131, 8259105, 2153506, 5587502, 3620294, 7579838, 4274616, 6536977, 6316443,
		3558640, 7270997, 2859681, 6708, 7174034, 7265499, 4993398, 2031572, 681982, 3816331,
		32605, 7084968, 3873232, 3271430, 3987907, 1762282, 3849002, 5287944, 7235526, 3238770,
		4603191, 2072540, 5517871, 1923030, 4073759, 633401, 6035220, 7385128, 7934987, 2275934,
		7150808, 1208180, 1963078, 4574449, 3097546, 423277, 33939, 1816342, 5346938, 7154052,
		4266988, 4981956, 5444284, 2556892, 5307963, 2297439, 396886, 128814, 4965893, 4016279,
		823032, 5953889, 5613265, 6178639, 6019913, 5181664, 7573210, 6290635, 3926986, 2491009,
		2858091, 6298969, 3083157, 4042563, 3957157, 5493913, 6727936, 7367552, 311795, 6431517,
		3812002, 1602020, 4788657, 6788391, 1469608, 2263977, 291809, 8107972, 3444176, 898205,
		2768530, 7363680, 2415669, 7022713, 4873648, 5730474, 6436448, 693126, 4448436, 7235500,
		7343100, 562886, 7412302, 1127506, 1562506, 6024506, 6679554, 940530, 6858383, 6300739,
		6317921, 1760556, 5439645, 6014980, 789391, 3928052, 3526531, 5011825, 3535130, 1694553,
		5289593, 5368839, 4795564, 5391778, 1639327, 1036088, 4218213, 2908934, 1803953, 7635048,
		3606555, 5842760, 6045472, 7377222, 3132725, 5923692, 4998584, 5585081, 6996107, 6220689,
		4315437, 6721713, 558182, 2038224, 4132444, 857901, 492108, 7036338, 8028880, 4971386,
		4659890, 6899136, 755543, 3875680, 6518563, 7337732, 3632904, 1802260, 3413068, 1281869,
		7471940, 7853206, 5707386, 7307696, 3867766, 2670738, 7588678, 3234552, 4967063, 6343452,
		2467966, 6732246, 6549574, 1482185, 1367481, 6369454, 4768565, 1621302, 1773188, 6287105,
		2355731, 7650954, 6435370, 4938117, 7768085, 5432449, 5351727, 4209202, 6087187, 4289454,
		3372968, 956388, 7123056, 5588183, 1288552, 7609073, 1067699, 2938495, 3749125, 331157,
		2921508, 6065322, 7354722, 772998, 941069, 3768576, 5216652, 2961318, 4988486, 197750,
		1763247, 1548702, 5859407, 5416613, 6035895, 1314282, 718819, 3145414, 1028697, 2347316,
		1983716, 3564524, 6598172, 7307403, 4000782, 1119653, 2371222, 6237912, 4662701, 5119849,
		4316780, 2824748, 428693, 125539, 5223808, 405380, 3276195, 3491517, 7703254, 3397967,
		2358454, 1771445, 1937500, 3207792, 4066724, 6732040, 2470138, 8130032, 5215917, 5474702,
		5952111, 6613793, 7928757, 7218089, 1949138, 4925255, 3964146, 4489609, 724620, 5451032,
		1046710, 736143, 4361721, 7199374, 8148485, 8039382, 7985486, 5442999, 5113912, 1170240,
		280951, 2355013, 636208, 55429, 509534, 7215816, 2000102, 6331191, 8372241, 742003,
		7943972, 2849389, 5149662, 3372653, 1488706, 4923920, 5468017, 7667222, 742800, 2288225,
		5380822, 4312651, 1945300, 4754917, 3398430, 6060480, 3515089, 7093682, 5886627, 7485004,
		7107107, 517627, 4886373, 4574607, 2555490, 8083830, 2015743, 5431387, 7484518, 3847849,
		8019424, 2451147, 4473920, 794022, 2119405, 7136740, 5237196, 2523675, 2767695, 6741433,
		3862418, 7948999, 7912863, 6805276, 8379986, 6011802, 5556136, 3791622, 5796227, 5455526,
		5427942, 1840336, 6995968, 8315083, 1038183, 6646286, 418907, 3180510, 6760361, 3780134,
		6676112, 2460357, 2738701, 6201392, 5572139, 331310, 201211, 1043203, 5461522, 3880934,
		104162, 622674, 5812447, 6201604, 3761498, 7915653, 5818357, 4634097, 7411680, 2239707,
		5537061, 2774720, 6411220, 6110969, 7999915, 1401882, 4339390, 5321764, 1248192, 5835285,
		6624408, 4668086, 60201, 6864231, 5353260, 403644, 2850771, 8070289, 3542736, 678329,
		6085120, 4927018, 1475244, 7357200, 4937901, 2546851, 6495349, 315822, 6680277, 7772154,
		7126170, 2499120, 7153368, 7732664, 7869125, 4200302, 8303377, 7926474, 5848408, 522077,
		2603630, 7425450, 2494890, 1865686, 1685180, 7525551, 1571893, 3615622, 3072805, 914838,
		8201354, 878690, 4240732, 3641980, 4771678, 2104462, 2381016, 8126825, 2979912, 4434445,
		5044182, 1145539, 831617, 2365237, 6528143, 2684003, 7055805, 8123434, 26078, 283978,
		2227060, 44971, 4324887, 5534039, 7203031, 5469288, 6300117, 2634235, 5831767, 3587239,
		5746646, 8111211, 678266, 3616471, 6040112, 5239657, 6742109, 4350070, 1716172, 2498905,
		3566891, 6785613, 8091204, 3903156, 2166890, 8148082, 8052202, 3311977, 1563179, 7098106,
		5830719, 1230544, 1813964, 5349934, 3863955, 6615383, 2662634, 7847525, 4267137, 687000,
		7566548, 4055981, 2697184, 5944034, 2487041, 7749148, 7977116, 3621653, 7421635, 7249490,
		7930900, 3264921, 2594908, 5964050, 5169008, 65077, 4381348, 5747175, 6458418, 1559021,
		5539270, 6086927, 3046070, 1064611, 7755078, 8305162, 4993683, 6358891, 177363, 4478502,
		8119303, 263488, 3520839, 7213499, 7617103, 8308566, 8358104, 865712, 3117217, 1021189,
		1284505, 8176229, 4078411, 1018916, 7771213, 2614766, 464816, 2375076, 2750474, 3352519,
		4567768, 5011586, 1238142, 4970007, 4935526, 5594472, 7907035, 384675, 7807100, 1486814,
		7285049, 6642011, 2051319, 669327, 3814943, 4737095, 7269306, 3170213, 367957, 2045954,
		528444, 2639906, 830308, 2132458, 1055481, 3147373, 3446121, 290163, 5123280, 7970674,
		5630145, 4154714, 5297385, 1972080, 3025737, 2000731, 2184928, 1035504, 3163875, 6354168,
		964448, 8002881, 5371184, 6644889, 6727259, 3822010, 1980966, 5329050, 4166661, 6865872,
		1628764, 5790303, 7594911, 4336562, 5190324, 7408888, 737659, 5593021, 5603139, 248548,
		6743694, 7538507, 3609466, 7199104, 6945336, 2569908, 6765057, 6215760, 4599651, 1692707,
		244103, 418298, 3031625, 3598377, 4661446, 4736619, 2112190, 2562993, 336613, 7432546,
		6340170, 3245857, 4339345, 6843876, 3367866, 7411576, 120187, 2377626, 4530752, 8198728,
		5851310, 506760, 6440990, 143572, 5492539, 1733300, 4165369, 4568221, 6151148, 5023239,
		4447028, 294867, 6244238, 1730729, 2858333, 5003954, 4679568, 7632738, 7980904, 6414384,
		6772053, 5347146, 3421220, 2469048, 2041467, 4839340, 2220122, 3235076, 4305555, 732578,
		3967422, 949193, 569912, 1947434, 3316242, 395226, 3663223, 4082431, 4787316, 3540910,
		6269973, 3746314, 1979517, 2382471, 4535086, 4814445, 4937873, 2004091, 2986924, 5073182,
		3151132, 4766713, 8278180, 3170408, 6179311, 7412975, 7955415, 5575726, 844076, 4433567,
		7402709, 1937632, 169943, 3114191, 6852553, 7024584, 6904118, 6911249, 3851126, 2163677,
		1645509, 8332714, 6034165, 4892743, 6896459, 4505701, 7620242, 8098515, 5967287, 7475118,
		4686393, 5843816, 3999014, 6355916, 5913300, 2541798, 3464140, 2386903, 6911289, 1054468,
		5042228, 381920, 821569, 2735930, 3367763, 6612197, 2478526, 4314283, 5639297, 3176535,
		5410114, 4643197, 4952956, 8245892, 422552, 5595693, 4251091, 6905395, 7689900, 5530345,
		7092462, 5160548, 676611, 7451551, 2957449, 4786919, 3027668, 1121309, 7128252, 6941130,
		3468275, 5919969, 2338957, 8138006, 7524259, 4397586, 7915085, 5580669, 4426411, 1711862,
		3677828, 8241758, 4381762, 1800245, 3112361, 272887, 1002203, 4774297, 1127565, 8097800,
		5137763, 3779106, 3472024, 5562308, 2302715, 3581739, 7192873, 4904912, 8346757, 7183481,
		5333102, 4732014, 4152951, 6886254, 740578, 3512832, 522993, 7118788, 467433, 6412857,
		3527347, 6462973, 5830670, 280714, 1959533, 5294897, 5028470, 4260666, 304781, 4556809,
		5843827, 6301656, 2893538, 1430741, 8063693, 2179950, 7446530, 1362692, 7722446, 5485628,
		6678181, 3058764, 2133024, 5352388, 5144329, 5350071, 5685661, 2810534, 6034527, 2332235,
		4852402, 8123980, 3267936, 7413434, 7226940, 2019228, 4456107, 296040, 1598253, 2182754,
		3783979, 1926084, 1439520, 4461576, 5017802, 6979531, 353489, 2936679, 2881372, 253197,
		4670305, 2867654, 6526041, 2643117, 5110325, 1076548, 6661473, 2430774, 6255396, 129747,
		3062799, 2099671, 492996, 2699940, 785268, 7810812, 5244377, 2846749, 5549487, 5400571,
		3888417, 5504416, 5927864, 2314762, 6857036, 7725762, 57848, 6746699, 1193794, 2512643,
		5581263, 7190788, 664621, 6094034, 1101682, 6804948, 250780, 7732526, 8366185, 4268214,
		3341571, 2921208, 2129397, 5680527, 2968598, 1814276, 6164395, 7999957, 7257661, 1317060,
		4519728, 425180, 3156592, 1659492, 5226861, 5711495, 3755787, 2565811, 7433159, 5559942,
		2441153, 581235, 6299927, 2542828, 2583075, 5255461, 3015363, 2038159, 5549919, 4196963,
		1905423, 3963322, 3740453, 4627781, 8177767, 2190073, 6847178, 8187862, 4544761, 4396628,
		1304196, 4373017, 2383368, 3436163, 5514287, 7873503, 7537877, 6185457, 7132475, 6194001,
		7341380, 1940785, 4256665, 7205185, 2760650, 6660217, 1655958, 171488, 5264437, 4999136,
		8304985, 4377535, 1413426, 2670247, 2835085, 2111788, 5675122, 5635567, 337773, 3579864,
		656130, 729987, 7576057, 1617575, 3051878, 3505919, 3113151, 2417246, 1220708, 8227062,
		3486980, 4553495, 286663, 4132632, 137520, 7937580, 4833041, 6351982, 6032837, 5488865,
		5949861, 7295640, 7173690, 4188912, 4791298, 516573, 5255859, 343061, 3421216, 8377523,
		3802782, 2459270, 3617566, 1392288, 1856134, 2701599, 6105087, 4079464, 1156967, 982998,
		2449736, 4137029, 704800, 767659, 2826547, 5414299, 6212709, 5925633, 750331, 1015382,
		5686475, 3025711, 8063051, 7693275, 5688606, 37134, 3613603, 3587724, 3801965, 4580345,
		4505446, 7315787, 2314251, 927600, 1221267, 5893651, 4161939, 5123457, 7960561, 1170649,
		3204419, 4511450, 2702202, 6240983, 5879217, 3920131, 3452942, 4409716, 6408607, 4545130,
		3696253, 1447684, 2749411, 4296667, 7756408, 564594, 3070026, 5708827, 5682374, 3743318,
		5770467, 560929, 4137487, 4033862, 4790664, 2593365, 3164905, 5967541, 3339874, 5942148,
		6486722, 3090334, 3449104, 4239378, 100472, 8110020, 3263179, 4992569, 3784933, 4855061,
		3668581, 4984025, 4317056, 5780406, 3811888, 6575426, 6666588, 8199606, 6783711, 2663485,
		3592224, 3403120, 7648302, 1308455, 1870817, 4781293, 731401, 1611999, 5039141, 7585966,
		1548776, 2065595, 1290774, 6384466, 2944230, 2352961, 909621, 3547595, 380231, 2922596,
		2109650, 17802, 5021260, 6967055, 6160588, 6036127, 987840, 7700372, 6855327, 3330876,
		5306034, 4412832, 591256, 1453588, 7393917, 7499749, 622744, 1252738, 3894986, 4739129,
		266048, 6785598, 8072657, 2346335, 484641, 5958168, 7407374, 6166750, 3230944, 290977,
		1665609, 1682853, 879392, 6603617, 7779754, 5356420, 3009975, 7738251, 2681456, 7551810,
		3546998, 3081592, 7140824, 7608277, 3232704, 6871664, 3022083, 6594304, 855344, 3767654,
		5020039, 2454081, 3117802, 6374984, 7497618, 3975077, 5702186, 3482807, 2364684, 5209707,
		7373490, 627734, 6103452, 3513420, 8242966, 5371960, 2637172, 2743433, 6149920, 374575,
		5421931, 3844435, 5940840, 1235541, 5732497, 2673767, 7530938};
#endif

#define Q_NTT_MULTI_Q1 (uint32_t)134250497
#define Q_NTT_MULTI_Q2 (uint32_t)536903681
void invntt_tomont_pre(int32_t *Out, int32_t *A) {
	int32_t zeta1;
	int32_t t1, t2;

	int len, start, j, k = 0;

	if (Out != A)
		memcpy(Out, A, sizeof(int32_t) * N);

#if ((NIMS_TRI_NTT_MODE != 3) && (NIMS_TRI_NTT_MODE != 55))
	int32_t zeta2;
	int32_t t3;
	for (len = 1; len <= radix3_len; len = 3 * len) {	 // radix-3
		for (start = 0; start < N; start += 3 * len) {
			zeta1 = zetas_inv[k++];
			zeta2 = zetas_inv[k++];
			for (j = start; j < start + len; j++) {
				t1 = (Out[j + len] - Out[j]) % Q;
				t1 = montgomery_reduce((int64_t)Wmont * t1);
				t2 = (t1 + Out[j + 2 * len] - Out[j]) % Q;
				t3 = (Out[j + 2 * len] - Out[j + len] - t1) % Q;
				Out[j] = (Out[j] + Out[j + 2 * len] + Out[j + len]) % Q;
				Out[j + len] = montgomery_reduce((int64_t)zeta1 * t2);
				Out[j + 2 * len] = montgomery_reduce((int64_t)zeta2 * t3);
			}
		}
	}
#endif
#if NIMS_TRI_NTT_MODE == 55
	for (len = 1; len < 1024; len <<= 1) {	// radix-2
		for (start = 0; start < N; start = j + len) {
			zeta1 = zetas_inv[k++];
			for (j = start; j < start + len; ++j) {
				t1 = Out[j];
				Out[j] = (t1 + Out[j + len]) % Q;
				Out[j + len] = (t1 - Out[j + len]) % Q;
				Out[j + len] = montgomery_reduce((int64_t)zeta1 * Out[j + len]);
			}
		}
	}
#else
	for (len = 3 * radix3_len; len <= N >> 2; len <<= 1) {	// radix-2
		for (start = 0; start < N; start = j + len) {
			zeta1 = zetas_inv[k++];
			for (j = start; j < start + len; ++j) {
				t1 = Out[j];
				Out[j] = (t1 + Out[j + len]) % Q;
				Out[j + len] = (t1 - Out[j + len]) % Q;
				Out[j + len] = montgomery_reduce((int64_t)zeta1 * Out[j + len]);
			}
		}
	}
#endif
	zeta1 = zetas_inv[k];
	for (int i = 0; i < N >> 1; i++) {
		t1 = Out[i] + Out[i + N / 2];
		t2 = montgomery_reduce((int64_t)zeta1 * (Out[i] - Out[i + N / 2]));

		Out[i] = montgomery_reduce((int64_t)F1_woo * (t1 - t2));
		Out[i + N / 2] = montgomery_reduce((int64_t)F2_woo * t2);
	}
}

void poly_caddq(poly *a) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		a->coeffs[i] = caddq(a->coeffs[i]);
}

void poly_add(poly *c, const poly *a, const poly *b) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		c->coeffs[i] = a->coeffs[i] + b->coeffs[i];
}

//void poly_modadd(poly *c, poly *a, poly *b) {
//	unsigned int i;
//
//	for (i = 0; i < N; ++i)
//		c->coeffs[i] = mod_add(a->coeffs[i], b->coeffs[i]);
//}

void poly_sub(poly *c, poly *a, poly *b) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		c->coeffs[i] = a->coeffs[i] - b->coeffs[i];
}

void poly_shiftl(poly *a) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		a->coeffs[i] <<= D;
}

void poly_power2round(poly *a1, poly *a0, const poly *a) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		a1->coeffs[i] = power2round(&a0->coeffs[i], a->coeffs[i]);
}

void poly_decompose(poly *a1, poly *a0, const poly *a) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		a1->coeffs[i] = decompose(&a0->coeffs[i], a->coeffs[i]);
}

unsigned int poly_make_hint(poly *h, const poly *a0, const poly *a1) {
	unsigned int i, s = 0;

	for (i = 0; i < N; ++i) {
		h->coeffs[i] = make_hint(a0->coeffs[i], a1->coeffs[i]);
		s += h->coeffs[i];
	}

	return s;
}

void poly_use_hint(poly *b, const poly *a, const poly *h) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		b->coeffs[i] = use_hint(a->coeffs[i], h->coeffs[i]);
}

int poly_chknorm(poly *a, int32_t B) {
	unsigned int i;
	int32_t t;

	if (B > (Q - 1) / 8)
		return 1;

	for (i = 0; i < N; ++i) {
		t = a->coeffs[i] >> 31;
		t = a->coeffs[i] - (t & 2 * a->coeffs[i]);

		if (t >= B) {
			return 1;
		}
	}
	return 0;
}

static unsigned int rej_uniform(int32_t *a, unsigned int len, const uint8_t *buf, unsigned int buflen) {
	unsigned int ctr, pos;
	uint32_t t;

#if NIMS_TRI_NTT_MODE == 55
	ctr = pos = 0;
	while (ctr < len && pos + 3 <= buflen) {
		t = buf[pos++];
		t |= (uint32_t)buf[pos++] << 8;
		t |= (uint32_t)buf[pos++] << 16;
		t &= 0x7FFFFF;
		if (t < Q && t != 0)
			a[ctr++] = t;
	}
#else
	ctr = pos = 0;
	while (ctr < len && pos + 3 <= buflen) {
		t = buf[pos++];
		t |= (uint32_t)buf[pos++] << 8;
		t |= (uint32_t)buf[pos++] << 16;
		t &= 0xFFFFFF;
		if (t < Q && t != 0)
			a[ctr++] = t;
	}
#endif
	return ctr;
}

#define POLY_UNIFORM_NBLOCKS ((768*2 + STREAM128_BLOCKBYTES - 1) / STREAM128_BLOCKBYTES)
void poly_uniform(poly *a,
									const uint8_t seed[SEEDBYTES],
									uint16_t nonce) {
	unsigned int i, ctr, off;
	unsigned int buflen = POLY_UNIFORM_NBLOCKS * STREAM128_BLOCKBYTES;
	uint8_t buf[POLY_UNIFORM_NBLOCKS * STREAM128_BLOCKBYTES + 2];
	stream128_state state;

	stream128_init(&state, seed, nonce);
	stream128_squeezeblocks(buf, POLY_UNIFORM_NBLOCKS, &state);

	ctr = rej_uniform(a->coeffs, N, buf, buflen);

	while (ctr < N) {
		off = buflen % 3;
		for (i = 0; i < off; ++i)
			buf[i] = buf[buflen - off + i];

		stream128_squeezeblocks(buf + off, 1, &state);
		buflen = STREAM128_BLOCKBYTES + off;
		ctr += rej_uniform(a->coeffs + ctr, N - ctr, buf, buflen);
	}
}

static unsigned int rej_eta(int32_t *a,
														unsigned int len,
														const uint8_t *buf,
														unsigned int buflen) {
	unsigned int ctr, pos;
	uint32_t t0, t1;
	uint32_t t2, t3;

	ctr = pos = 0;
	while (ctr < len && pos < buflen) {
		t0 = buf[pos] & 0x03;
		t1 = (buf[pos] >> 2) & 0x03;
		t2 = (buf[pos] >> 4) & 0x03;
		t3 = buf[pos++] >> 6;
		if (t0 < 3) {
			a[ctr++] = 1 - t0;
		}
		if (t1 < 3 && ctr < len) {
			a[ctr++] = 1 - t1;
		}
		if (t2 < 3 && ctr < len) {
			a[ctr++] = 1 - t2;
		}
		if (t3 < 3 && ctr < len) {
			a[ctr++] = 1 - t3;
		}
	}

	return ctr;
}

#define POLY_UNIFORM_ETA_NBLOCKS ((136 + STREAM256_BLOCKBYTES - 1) / STREAM256_BLOCKBYTES)
void poly_uniform_eta(poly *a,
											const uint8_t seed[CRHBYTES],
											uint16_t nonce) {
	unsigned int ctr;
	unsigned int buflen = POLY_UNIFORM_ETA_NBLOCKS * STREAM256_BLOCKBYTES;
	uint8_t buf[POLY_UNIFORM_ETA_NBLOCKS * STREAM256_BLOCKBYTES];
	stream256_state state;

	stream256_init(&state, seed, nonce);
	stream256_squeezeblocks(buf, POLY_UNIFORM_ETA_NBLOCKS, &state);

	ctr = rej_eta(a->coeffs, N, buf, buflen);

	while (ctr < N) {
		stream256_squeezeblocks(buf, 1, &state);
		ctr += rej_eta(a->coeffs + ctr, N - ctr, buf, STREAM256_BLOCKBYTES);
	}
}

#define POLY_UNIFORM_GAMMA1_NBLOCKS ((POLYZ_PACKEDBYTES + STREAM256_BLOCKBYTES - 1) / STREAM256_BLOCKBYTES)

void poly_uniform_gamma1(poly *a,
												 const uint8_t seed[CRHBYTES],
												 uint16_t nonce) {
	uint8_t buf[POLY_UNIFORM_GAMMA1_NBLOCKS * STREAM256_BLOCKBYTES];
	stream256_state state;

	stream256_init(&state, seed, nonce);
	stream256_squeezeblocks(buf, POLY_UNIFORM_GAMMA1_NBLOCKS, &state);
	polyz_unpack(a, buf);
}
// sample in ball
void poly_challenge(poly *c, const uint8_t seed[SEEDBYTES]) {
	unsigned int i, b, pos;
	uint32_t signs;
	uint8_t buf[SHAKE256_RATE] = {0};
	keccak_state state;

	shake256_init(&state);
	shake256_absorb(&state, seed, SEEDBYTES);
	shake256_finalize(&state);
	shake256_squeezeblocks(buf, 1, &state);

	signs = 0;
	for (i = 0; i < 4; ++i)
		signs |= (uint32_t)buf[i] << 8 * i;
	pos = 4;

	for (i = 0; i < N; ++i)
		c->coeffs[i] = 0;
#if (N == 2304)
	for (i = N - TAU; i < N; ++i) {
		do {
			if (pos >= SHAKE256_RATE) {
				shake256_squeezeblocks(buf, 1, &state);
				pos = 0;
			}

			b = (uint32_t)buf[pos++] << 4;
			b |= (buf[pos++] & 0xF);
		} while (b > i);

		c->coeffs[i] = c->coeffs[b];
		c->coeffs[b] = 1 - 2 * (signs & 1);
		signs >>= 1;
	}
#else
	for (i = N - TAU; i < N; ++i) {
		do {
			if (pos >= SHAKE256_RATE) {
				shake256_squeezeblocks(buf, 1, &state);
				pos = 0;
			}

			b = (uint32_t)buf[pos++] << 3;
			b |= (buf[pos++] & 0x7);
		} while (b > i);

		c->coeffs[i] = c->coeffs[b];
		c->coeffs[b] = 1 - 2 * (signs & 1);
		signs >>= 1;
	}
#endif
}
/*************************************************
 * Name:        poly_reduce
 *
 * Description: Inplace reduction of all coefficients of polynomial to
 *              representative in [-6283009,6283007](�뜝�럥��占쎈뎨占쎈봾六삣뜝�룞�삕).
 *
 * Arguments:   - poly *a: pointer to input/output polynomial
 **************************************************/
void poly_reduce(poly *a) {
	unsigned int i;

	for (i = 0; i < N; ++i)
		a->coeffs[i] = reduce32(a->coeffs[i]);
}
static int32_t crt_mode(const int32_t a, int32_t b_pinv, int32_t b, int32_t p) {
  int32_t t, u;
  t = ((int64_t)a * b_pinv) & 0xffffffff;
  u = (((int64_t)a * b) >> 32) & 0xffffffff;
  t = (((int64_t)t * p) >> 32) & 0xffffffff;
  t = u - t;
  return t;
}
#define Q1_MONT   -1048608
#define MONT_PINV   -32
#define CRT_U   178967883
#define CRT_U_PINV   349515
#if N == 1152
#define Q_NTT_MULTI_Q1_MONT 386733
#elif N == 1536
#define Q_NTT_MULTI_Q1_MONT -1631956
#elif N == 2304
#define Q_NTT_MULTI_Q1_MONT -1761374
#elif N == 2048
#define Q_NTT_MULTI_Q1_MONT -3752511
#endif
void ntt_crt(poly *c, poly *a, poly *b) {
  int32_t tmp0[N] = {0x00};
  int32_t tmp1[N] = {0x00};

  for (int32_t i = 0; i < N; i++) {
    tmp0[i] = crt_mode(a->coeffs[i], MONT_PINV, Q1_MONT, Q_NTT_MULTI_Q1);
  }

  for (int32_t i = 0; i < N; i++) {
    tmp1[i] = b->coeffs[i] - tmp0[i];
  }

  for (int32_t i = 0; i < N; i++) {
    tmp1[i] = crt_mode(tmp1[i], CRT_U_PINV, CRT_U, Q_NTT_MULTI_Q2);
  }

  for (int32_t i = 0; i < N; i++)
  {
	tmp1[i] = montgomery_reduce((int64_t)tmp1[i] * Q_NTT_MULTI_Q1_MONT);
  }

  for (int32_t i = 0; i < N; i++) {
    c->coeffs[i] = reduce32((tmp0[i] + tmp1[i]));
  }
}
